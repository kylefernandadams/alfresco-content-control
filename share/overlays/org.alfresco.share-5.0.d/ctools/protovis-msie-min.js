/*!
 * Copyright 2002 - 2013 Webdetails, a Pentaho company.  All rights reserved.
 *
 * This software was developed by Webdetails and is provided under the terms
 * of the Mozilla Public License, Version 2.0, or any later version. You may not use
 * this file except in compliance with the license. If you need a copy of the license,
 * please go to  http://mozilla.org/MPL/2.0/. The Initial Developer is Webdetails.
 *
 * Software distributed under the Mozilla Public License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or  implied. Please refer to
 * the license for the specific language governing your rights and limitations.
 */
;
/*!
 * Protovis MSIE/VML addon
 * Copyright (C) 2011 by DataMarket <http://datamarket.com>
 * Dual licensed under the terms of the MIT or GPL Version 2 software licenses.
 * 
 * This software includes code from jQuery, http://jquery.com/
 * jQuery is licensed under the MIT or GPL Version 2 license.
 * 
 * This software includes code from the Protovis, http://mbostock.github.com/protovis/
 * Protovis is licensed under the BSD license.
 * 
 */
;pv.have_SVG=!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect);pv.have_VML=function(f,e,c){e=f.createElement("div");e.innerHTML='<pvml:shape adj="1" />';c=e.firstChild;c.style.behavior="url(#default#VML)";return c?"object"==typeof c.adj:!0}(document);!pv.have_SVG&&pv.have_VML&&!function(){"function"!=typeof Date.now&&(Date.now=function(){return 1*new Date()});var a={is64Bit:"x64"===window.navigator.cpuClass,round:function(b){return Math.round(21.6*(b||0))},styles:null,pre:"<pvml:",post:' class="msvml">',block:{group:1,shape:1,shapetype:1,line:1,polyline:1,curve:1,rect:1,roundrect:1,oval:1,arc:1,image:1},caps:{butt:"flat",round:"round",square:"square"},joins:{bevel:"bevel",round:"round",miter:"miter"},cursorstyles:{hand:"pointer",crosshair:1,pointer:1,move:1,text:1,wait:1,help:1,progress:1,"n-resize":1,"ne-resize":1,"nw-resize":1,"s-resize":1,"se-resize":1,"sw-resize":1,"e-resize":1,"w-resize":1},text_shim:null,text_dims:function(c,b){var d=a.text_shim||(a.init(),a.text_shim);d.style.font=a.processFont(b);d.innerText=c;return{height:d.offsetHeight,width:d.offsetWidth}},_fontCache:{},_fontSubst:{"default":"Arial","sans-serif":"Arial",sansserif:"Arial",sans:"Arial",serif:"Times New Roman",dialog:"Arial",monospaced:"Courier New",dialoginput:"Courier New"},_fontWhiteListIE64Bit:{"agency fb":1,aharoni:1,algerian:1,andalus:1,"angsana new":1,angsanaupc:1,aparajita:1,"arabic typesetting":1,arial:1,"arial black":1,"arial narrow":1,"arial rounded mt bold":1,"arial unicode ms":1,"baskerville old face":1,batang:1,batangche:1,"bauhaus 93":1,"bell mt":1,"berlin sans fb":1,"berlin sans fb demi":1,"bernard mt condensed":1,"blackadder itc":1,"bodoni mt":1,"bodoni mt black":1,"bodoni mt condensed":1,"bodoni mt poster compressed":1,"book antiqua":1,"bookman old style":1,"bookshelf symbol 7":1,"bradley hand itc":1,"britannic bold":1,broadway:1,"browallia new":1,browalliaupc:1,"brush script mt":1,calibri:1,"californian fb":1,"calisto mt":1,cambria:1,"cambria math":1,candara:1,castellar:1,centaur:1,century:1,"century gothic":1,"century schoolbook":1,chiller:1,"colonna mt":1,"comic sans ms":1,consolas:1,constantia:1,"cooper black":1,"copperplate gothic bold":1,"copperplate gothic light":1,corbel:1,"cordia new":1,cordiaupc:1,"courier new":1,"curlz mt":1,daunpenh:1,david:1,"dfkai-sb":1,dilleniaupc:1,dokchampa:1,dotum:1,dotumche:1,ebrima:1,"edwardian script itc":1,elephant:1,"engravers mt":1,"eras bold itc":1,"eras demi itc":1,"eras light itc":1,"eras medium itc":1,"estrangelo edessa":1,eucrosiaupc:1,euphemia:1,fangsong:1,"felix titling":1,"footlight mt light":1,forte:1,"franklin gothic book":1,"franklin gothic demi":1,"franklin gothic demi cond":1,"franklin gothic heavy":1,"franklin gothic medium":1,"franklin gothic medium cond":1,frankruehl:1,freesiaupc:1,"freestyle script":1,"french script mt":1,gabriola:1,garamond:1,gautami:1,georgia:1,gigi:1,"gill sans mt":1,"gill sans mt condensed":1,"gill sans mt ext condensed bold":1,"gill sans ultra bold":1,"gill sans ultra bold condensed":1,gisha:1,"gloucester mt extra condensed":1,"goudy old style":1,"goudy stout":1,gulim:1,gulimche:1,gungsuh:1,gungsuhche:1,"guttman adii":1,"guttman adii-light":1,"guttman aharoni":1,"guttman calligraphic":1,"guttman david":1,"guttman drogolin":1,"guttman frank":1,"guttman frnew":1,"guttman haim":1,"guttman haim-condensed":1,"guttman hatzvi":1,"guttman hodes":1,"guttman kav":1,"guttman kav-light":1,"guttman keren":1,"guttman logo1":1,"guttman mantova":1,"guttman mantova-decor":1,"guttman miryam":1,"guttman myamfix":1,"guttman rashi":1,"guttman stam":1,"guttman stam1":1,"guttman vilna":1,"guttman yad":1,"guttman yad-brush":1,"guttman yad-light":1,"guttman-aharoni":1,"guttman-aram":1,"guttman-courmir":1,"guttman-soncino":1,"guttman-toledo":1,haettenschweiler:1,"harlow solid italic":1,harrington:1,"high tower text":1,impact:1,"imprint mt shadow":1,"informal roman":1,irisupc:1,"iskoola pota":1,jasmineupc:1,jokerman:1,"juice itc":1,kaiti:1,kalinga:1,kartika:1,"khmer ui":1,kodchiangupc:1,kokila:1,"kristen itc":1,"kunstler script":1,"lao ui":1,latha:1,leelawadee:1,"levenim mt":1,lilyupc:1,"lucida bright":1,"lucida calligraphy":1,"lucida console":1,"lucida fax":1,"lucida handwriting":1,"lucida sans":1,"lucida sans typewriter":1,"lucida sans unicode":1,magneto:1,"maiandra gd":1,"malgun gothic":1,mangal:1,marlett:1,"matura mt script capitals":1,meiryo:1,"meiryo ui":1,"microsoft himalaya":1,"microsoft jhenghei":1,"microsoft new tai lue":1,"microsoft phagspa":1,"microsoft sans serif":1,"microsoft tai le":1,"microsoft uighur":1,"microsoft yahei":1,"microsoft yi baiti":1,mingliu:1,"mingliu-extb":1,mingliu_hkscs:1,"mingliu_hkscs-extb":1,miriam:1,"miriam fixed":1,mistral:1,"modern no. 20":1,"mongolian baiti":1,"monotype corsiva":1,"monotype hadassah":1,moolboran:1,"ms gothic":1,"ms mincho":1,"ms outlook":1,"ms pgothic":1,"ms pmincho":1,"ms reference sans serif":1,"ms reference specialty":1,"ms ui gothic":1,"mt extra":1,"mv boli":1,narkisim:1,"niagara engraved":1,"niagara solid":1,nsimsun:1,nyala:1,"ocr a extended":1,"old english text mt":1,onyx:1,"palace script mt":1,"palatino linotype":1,papyrus:1,parchment:1,perpetua:1,"perpetua titling mt":1,"plantagenet cherokee":1,playbill:1,pmingliu:1,"pmingliu-extb":1,"poor richard":1,pristina:1,raavi:1,"rage italic":1,ravie:1,rockwell:1,"rockwell condensed":1,"rockwell extra bold":1,rod:1,"sakkal majalla":1,"script mt bold":1,"segoe print":1,"segoe script":1,"segoe ui":1,"segoe ui light":1,"segoe ui semibold":1,"segoe ui symbol":1,"shonar bangla":1,"showcard gothic":1,shruti:1,simhei:1,"simplified arabic":1,"simplified arabic fixed":1,simsun:1,"simsun-extb":1,"snap itc":1,stencil:1,sylfaen:1,symbol:1,tahoma:1,"tempus sans itc":1,"times new roman":1,"toptype soncino":1,"traditional arabic":1,"trebuchet ms":1,tunga:1,"tw cen mt":1,"tw cen mt condensed":1,"tw cen mt condensed extra bold":1,utsaah:1,vani:1,verdana:1,vijaya:1,"viner hand itc":1,vivaldi:1,"vladimir script":1,vrinda:1,webdings:1,"wide latin":1,wingdings:1,"wingdings 2":1,"wingdings 3":1},_defaultFontIE64Bit:"Arial",processFont:function(c){var g=a._fontCache[c];if(!g){var h=a.text_shim||(a.init(),a.text_shim),e=h.style;e.font=c;var b=e.fontFamily;'"'===b.charAt(0)&&(b=b.substr(1,b.length-1));var f=b.toLowerCase(),d=a._fontSubst[f];d?b=d:a.is64Bit&&!a._fontWhiteListIE64Bit[f]&&(b=a._defaultFontIE64Bit);e.fontFamily='"'+b+'"';a._fontCache[c]=g=e.font}return g},get_dim:function(b,f){var g=f||{};g.rotation=g.tx=g.ty=0;g.sx=g.sy=1;var h=b.transform;if(h){var c=/translate\((-?\d+(?:\.\d+)?(?:e-?\d+)?)(?:,(-?\d+(?:\.\d+)?(?:e-?\d+)?))?\)/.exec(h);if(c){c[1]&&(g.tx=+c[1]);c[2]&&(g.ty=+c[2])}var e=/rotate\((-?\d+(?:\.\d+)?(?:e-?\d+)?)\)/.exec(h);if(e){var e=+e[1]%360;0>e&&(e+=360);e=pv.radians(e)}var d=/scale\((-?\d+(?:\.\d+)?(?:e-?\d+)?)(?:,(-?\d+(?:\.\d+)?(?:e-?\d+)?))?\)/.exec(h);if(d){d[1]&&(g.sx=+d[1]);d[2]&&(g.sy=+d[2])}g.rotation=e||0}g.x=parseFloat(b.x||0);g.y=parseFloat(b.y||0);"width" in b&&(g.width=parseFloat(b.width));"height" in b&&(g.height=parseFloat(b.height));return g},solidFillStyle:{type:"solid"},elm_defaults:{g:{rewrite:"span",attr:function(b,c,f){var e=a.get_dim(b);f.style.cssText="position:absolute;zoom:1;left:"+(e.tx+e.x)+"px;top:"+(e.ty+e.y)+"px;"}},line:{rewrite:"shape",attr:function(h,c,j,g,f){var e=parseFloat(h.x1||0),l=parseFloat(h.y1||0),d=parseFloat(h.x2||0),k=parseFloat(h.y2||0),b=a.round;j.coordorigin="0,0";j.coordsize="21600,21600";a.path(j).v="M "+b(e)+" "+b(l)+" L "+b(d)+" "+b(k)+" E";a.stroke(j,h,g,f)},css:"top:0px;left:0px;width:1000px;height:1000px"},rect:{rewrite:"shape",attr:function(k,c,l,j,f){var m=a.get_dim(k),e=a.path(l),b=a.round;l.coordorigin="0,0";l.coordsize="21600,21600";var o=b(m.tx+m.x),n=b(m.ty+m.y),q=b(m.width),g=b(m.height);e.v="M "+o+" "+n+" L "+(o+q)+" "+n+" L "+(o+q)+" "+(n+g)+" L "+o+" "+(n+g)+" x";a.stroke(l,k,j,f);a.fill(l,k,j,f)},css:"top:0px;left:0px;width:1000px;height:1000px"},path:{rewrite:"shape",attr:function(b,f,k,g,e){var j=a.get_dim(b),h=k.style;h.visibility="hidden";h.left=j.tx+j.x+"px";h.top=j.ty+j.y+"px";k.coordorigin="0,0";k.coordsize="21600,21600";k._events=b["pointer-events"]||"none";a.path(k,b.d);var c=a.rotateAndScale(k,j.rotation&&-j.rotation,j.sx,j.sy);c&&(c.origin="-0.5,-0.5");a.fill(k,b,g,e);a.stroke(k,b,g,e);h.visibility="visible"},css:"top:0px;left:0px;width:1000px;height:1000px;"},ellipse:{rewrite:"oval",attr:function(h,c,j,g,f){var k=a.get_dim(h),e=h.rx,b=h.ry,l=j.style;l.left=k.tx-e+"px";l.top=k.ty-b+"px";l.width=2*e+"px";l.height=2*b+"px";var m=a.rotateAndScale(j,k.rotation&&-k.rotation);m&&(m.origin="0,0");a.fill(j,h,g,f);a.stroke(j,h,g,f)}},circle:{rewrite:"oval",attr:function(j,c,k,h,g){var l=a.get_dim(j),b=parseFloat(j.r||0)+0.5,f=parseFloat(j.cx||0)+0.7,e=parseFloat(j.cy||0)+0.7,m=k.style;m.left=l.tx+f-b+"px";m.top=l.ty+e-b+"px";m.width=m.height=2*b+"px";a.fill(k,j,h,g);a.stroke(k,j,h,g)}},text:{rewrite:"shape",attr:function(b,e,j,f,c){j.style;j.stroked="False";j.path="m0,0 l1,0 e";var h=a.textpath(j);h.string=b.string;var g=h.style;g["v-text-align"]=b.textAlign;g.font=b.font;b.textDecoration&&(g.textDecoration=b.textDecoration);a.path(j).textpathok="True";a.rotateAndScale(j,b.rotation&&-b.rotation);var d=f[c];d.fillStyle=a.solidFillStyle;a.fill(j,b,f,c);d.fillStyle=null},css:"position:absolute;top:0px;left:0px;width:1px;height:1px;"},svg:{rewrite:"span",css:"position:relative;overflow:hidden;display:inline-block;"},"vml:path":{rewrite:"path"},"vml:stroke":{rewrite:"stroke"},"vml:fill":{rewrite:"fill"},"vml:textpath":{rewrite:"textpath"},"vml:skew":{rewrite:"skew"}},_elmcache:{span:document.createElement("span"),div:document.createElement("div")},createElement:function(d){var f,b=a._elmcache,e=a.elm_defaults[d]||{},c=e.rewrite||d;if(c in b){f=b[c].cloneNode(!1)}else{b[c]=document.createElement(a.pre+c+a.post);c in a.block&&(b[c].className+=" msvml_block");f=b[c].cloneNode(!1)}e.css&&(f.style.cssText=e.css);return f},_hex:pv.range(0,256).map(function(b){return pv.Format.pad("0",2,b.toString(16))}),_colorcache:{},color:function(d){var c,b=a._colorcache[d];!b&&(c=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(d))&&(a._colorcache[d]=b="#"+a._hex[c[1]]+a._hex[c[2]]+a._hex[c[3]]);return b||d},fill:function(j,h,g,f){var o=j.getElementsByTagName("fill")[0]||(o=j.appendChild(a.createElement("vml:fill"))),m=g[f].fillStyle,e=m&&m.type;e||(e="solid");if(!h.fill||!m||"solid"===e&&"none"===h.fill){o.on="false"}else{o.on="true";if("solid"===e){o.type="solid";o.color=a.color(h.fill)}else{var b="lineargradient"===e;o.method="none";var n=m.stops,d=n.length;if(d>0){for(var k=[],f=0;d>f;f++){var l=n[f];k.push(l.offset+"% "+a.color(l.color.color))}o.colors&&"object"==typeof o.colors?o.colors.value=k.join(","):o.colors=k.join(",")}if(b){o.type="gradient";var c=-pv.degrees(m.angle)%360;o.angle=0>c?c+360:c}else{o.type="gradientTitle";o.focus="100%";o.focussize="0 0";o.focusposition="0 0";o.angle=0}}o.opacity=Math.min(parseFloat(h["fill-opacity"]||"1"),1)||"1"}},stroke:function(f,b){var d=f.getElementsByTagName("stroke")[0]||(d=f.appendChild(a.createElement("vml:stroke")));if(b.stroke&&"none"!==b.stroke){var e=b["stroke-width"];e=null==e||""===e?1:+e;1e-10>e?e=0:1>e&&(e=1);if(e){d.on="true";d.weight=e;d.color=a.color(b.stroke)||"black";d.opacity=Math.min(parseFloat(b["stroke-opacity"]||"1"),1)||"1";d.joinstyle=a.joins[b["stroke-linejoin"]]||"miter";d.miterlimit=b["stroke-miterlimit"]||8;d.endcap=a.caps[b["stroke-linecap"]]||"flat";var c=b["stroke-dasharray"];c&&"none"!==c||(c="Solid");d.dashstyle=c}else{d.on="false";d.weight=0}}else{d.on="false";d.weight=0}},path:function(d,b){var c=d.getElementsByTagName("path")[0]||(c=d.appendChild(a.createElement("vml:path")));arguments.length>1&&(c.v=a.rewritePath(b));return c},skew:function(c){var b=c.getElementsByTagName("skew")[0]||(b=c.appendChild(a.createElement("vml:skew")));b.on="false";return b},rotateAndScale:function(f,b,h,g){b&&(b=pv.radians(Math.round(pv.degrees(b))%360));var d=h&&1!==h||g&&1!==g;if(b||d){var j=a.skew(f);j.on="true";j.offset="0,0";h||(h=1);g||(g=1);var c;if(b){var e=Math.cos(b),i=Math.sin(b);c=(h*e).toFixed(8)+","+(g*i).toFixed(8)+","+(h*-i).toFixed(8)+","+(g*e).toFixed(8)+",0,0"}else{c=h.toFixed(8)+",0,0,"+g.toFixed(8)+",0,0"}j.matrix=c;return j}},textpath:function(c){var b=c.getElementsByTagName("textpath")[0]||(b=c.appendChild(a.createElement("vml:textpath")));b.style["v-text-align"]="center";b.style["v-text-kern"]="true";b.on="true";return b},init:function(){if(!a.text_shim){a.text_shim=document.getElementById("pv_vml_text_shim")||document.createElement("span");a.text_shim.id="protovisvml_text_shim";a.text_shim.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline-block;white-space:nowrap;";document.body.appendChild(a.text_shim)}if(!a.styles){a.styles=document.getElementById("protovisvml_styles")||document.createElement("style");a.styles.id="protovisvml_styles";document.documentElement.firstChild.appendChild(a.styles);a.styles.styleSheet.addRule(".msvml","behavior:url(#default#VML);");a.styles.styleSheet.addRule(".msvml_block","position:absolute;top:0;left:0;");try{document.namespaces.pvml||document.namespaces.add("pvml","urn:schemas-microsoft-com:vml")}catch(b){a.pre="<";a.post=' class="msvml" xmlns="urn:schemas-microsoft.com:vml">'}}},_pathcache:{},rewritePath:function(d){var q=0,n=0,t=a.round;if(!d){return d}if(d in a._pathcache){return a._pathcache[d]}d=d.replace(/(\d*)((\.*\d*)(e ?-?\d*))/g,"$1");for(var s=d.match(/([MLHVCSQTAZ ][^MLHVCSQTAZ ]*)/gi),r=[],f=[],j="",g=0,e=s.length;e>g;g++){var m=s[g],h=m.charAt(0),k=m.substring(1).split(/[,]/);" "==h&&(h=j);j=h;switch(h){case"M":h="m";q=t(k[0]);n=t(k[1]);k=[q,n];break;case"m":h="m";q+=t(k[0]);n+=t(k[1]);k=[q,n];break;case"A":h="l";k=[q=t(k[5]),n=t(k[6])];break;case"L":h="l";k=[q=t(k[0]),n=t(k[1])];break;case"l":h="l";k=[q+=t(k[0]),n+=t(k[1])];break;case"H":h="l";k=[q=t(k[0]),n];break;case"h":h="l";k=[q+=t(k[0]),n];break;case"V":h="l";k=[q,n=t(k[0])];break;case"v":h="l";k=[q,n+=t(k[0])];break;case"C":h="c";f=k=[t(k[0]),t(k[1]),t(k[2]),t(k[3]),q=t(k[4]),n=t(k[5])];break;case"c":h="c";f=k=[q+t(k[0]),n+t(k[1]),q+t(k[2]),n+t(k[3]),q+=t(k[4]),n+=t(k[5])];break;case"S":h="c";f=k=[f[4]+(f[4]-f[2]),f[5]+(f[5]-f[3]),t(k[0]),t(k[1]),q=t(k[2]),n=t(k[3])];break;case"s":h="c";f=k=[f[4]+(f[4]-f[2]),f[5]+(f[5]-f[3]),q+t(k[0]),n+t(k[1]),q+=t(k[2]),n+=t(k[3])];break;case"Q":h="c";var c=t(k[0]),o=t(k[1]),b=t(k[2]),l=t(k[3]);k=[~~(q+2*(c-q)/3),~~(n+2*(o-n)/3),~~(c+(b-c)/3),~~(o+(l-o)/3),q=b,n=l];break;case"q":h="l";q+=t(k[2]);n+=t(k[3]);k=[q,n];break;case"Z":case"z":h="xe";k=[];break;default:h="";k=[]}r.push(h,k.join(","))}return a._pathcache[d]=r.join("")+"e"}};pv.Text.measure=a.text_dims;pv.Vml=a;pv.VmlScene={scale:1,events:["mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick","contextmenu"],mousePositionEventSet:pv.Scene.mousePositionEventSet,eventsToNumber:pv.Scene.eventsToNumber,numberToEvents:pv.Scene.numberToEvents,implicit:{css:{}},copy_functions:function(c){for(var b in c){"function"!=typeof c[b]||b in pv.VmlScene||(pv.VmlScene[b]=c[b])}}};pv.VmlScene.copy_functions(pv.SvgScene);pv.Scene=pv.VmlScene;pv.renderer=function(){return"vml"};!function(b){pv.VmlScene.minRuleLineWidth=b?1.2:1.1;pv.VmlScene.minBarWidth=b?2.2:1.8;pv.VmlScene.minBarHeight=b?2.2:1.8;pv.VmlScene.minBarLineWidth=b?1.2:1}(a.is64Bit);pv.VmlScene.expect=function(j,l,h,f,k,b){b=b||{};var d=a.elm_defaults[l]||{},g=d.rewrite||l;if(j){if(j.tagName.toUpperCase()!==g.toUpperCase()){var c=a.createElement(l);j.parentNode.replaceChild(c,j);j=c}}else{j=a.createElement(l)}if(k){"attr" in d&&d.attr(k,b,j,h,f);if(k.cursor in a.cursorstyles){var m=a.cursorstyles[k.cursor];b.cursor=1===m?k.cursor:m}}b&&this.setStyle(j,b);return j};pv.VmlScene.removeSiblings=function(b){for(;b;){var c=b.nextSibling;b.parentNode.removeChild(b);b=c}};pv.VmlScene.addFillStyleDefinition=function(){};pv.VmlScene.setAttributes=function(){};pv.VmlScene.setStyle=function(h,d){var f=h.__style__;f===d&&(f=null);var b=h.style;for(var c in d){var g=d[c];f&&g===f[c]||(null==g?b.removeAttribute(c):b[c]=g)}h.__style__=d};pv.VmlScene.append=function(d,c,b){d.$scene={scenes:c,index:b};d=this.title(d,c[b]);d.parentNode&&11!==d.parentNode.nodeType||c.$g.appendChild(d);return d.nextSibling};pv.VmlScene.title=function(c,b){c.title=b.title||"";return c};pv.VmlScene.panel=function(N){for(var J,K=N.$g,M=K&&K.firstChild,H=!1,G=0,n=N.length;n>G;G++){var v=N[G];if(v.visible){if(!N.parent){var f=v.canvas;J=f.style;J.display="inline-block";J.zoom=1;if(K&&K.parentNode!==f){K=f.firstChild;M=K&&K.firstChild}if(!K){H=!0;a.init();K=f.appendChild(a.createElement("svg"));K.unselectable="on";K.onselectstart=function(){return !1};for(var d=this.events,P=this.dispatch,F=0,u=d.length;u>F;F++){K.addEventListener?K.addEventListener(d[F],P,!1):K.attachEvent("on"+d[F],P)}M=K.firstChild}N.$g=K;var q=v.width+v.left+v.right,I=v.height+v.top+v.bottom;J=K.style;J.width=q+"px";J.height=I+"px";J.clip="rect(0px "+q+"px "+I+"px 0px)"}var O;if("hidden"===v.overflow){O=this.expect(M,"g",N,G);O.style.position="absolute";O.style.clip="rect("+v.top.toFixed(2)+"px "+(v.left+v.width).toFixed(2)+"px "+(v.top+v.height).toFixed(2)+"px "+v.left.toFixed(2)+"px)";O.parentNode||K.appendChild(O);N.$g=K=O;M=O.firstChild}M=this.fill(M,N,G);var D=this.scale,r=v.transform,p=v.left+r.x,o=v.top+r.y;this.scale*=r.k;if(v.children.length){for(var B={transform:"translate("+p+","+o+")"+(1!=r.k?" scale("+r.k+")":"")},A=this.getSortedChildScenes(N,G),F=0,z=A.length;z>F;F++){var l=A[F];l.$g=M=this.expect(M,"g",N,G,B);this.updateAll(l);var m=M.parentNode;if(!m||11===m.nodeType){K.appendChild(M);var b=a.elm_defaults[M.svgtype];b&&"function"==typeof b.onappend&&b.onappend(M,N[G])}M=M.nextSibling}}this.scale=D;M=this.stroke(M,N,G);if(O){N.$g=K=O.parentNode;M=O.nextSibling}}}if(H){this.removeSiblings(M);M=K.appendChild(a.createElement("oval"))}return M};pv.VmlScene.parseDasharray=function(d){var b=d.strokeDasharray;if(b&&"none"!==b){var c=this.translateDashStyleAlias(b);if(this.isStandardDashStyle(c)){b=c}else{b=b.split(/[\s,]+/).map(function(e){return +e/this.scale},this);b.length%2&&(b=b.concat(b));b=b.join(" ")}}else{b=null}return b};pv.VmlScene.create=function(b){return a.createElement(b)};!function(){function e(h){if(h&&h.type){this.originalEvent=h;this.type=h.type;this.isDefaultPrevented=b;(h.defaultPrevented||h.returnValue===!1||h.getPreventDefault&&h.getPreventDefault())&&(this.isDefaultPrevented=g);this.timeStamp=h.timeStamp||Date.now()}else{this.type=h;this.timeStamp=Date.now()}}var g=function(){return !0},b=function(){return !1},d=["altKey","attrChange","attrName","bubbles","button","cancelable","charCode","clientX","clientY","ctrlKey","currentTarget","data","detail","eventPhase","fromElement","handler","keyCode","layerX","layerY","metaKey","newValue","offsetX","offsetY","pageX","pageY","prevValue","relatedNode","relatedTarget","screenX","screenY","shiftKey","srcElement","target","toElement","view","wheelDelta","which"],c=d.length;e.prototype={preventDefault:function(){this.isDefaultPrevented=g;var h=this.originalEvent;h&&(h.preventDefault?h.preventDefault():h.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=g;var h=this.originalEvent;if(h){h.stopPropagation&&h.stopPropagation();h.cancelBubble=!0}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g;this.stopPropagation()},isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b};var f=document.compatMode&&"BackCompat"!=document.compatMode?"documentElement":"body";a.fixEvent=function(r){var j=r;r=new e(j);for(var p=r.type,s="keypress"===p,n=c;n;){var h=d[--n];r[h]=j[h]}var o=r.target;if(!o){o=r.srcElement||document;3===o.nodeType&&(o=o.parentNode);r.target=o}var q;!r.relatedTarget&&(q=r.fromElement)&&(r.relatedTarget=q===o?r.toElement:q);if(!s){var k;if(null==r.pageX&&null!=(k=r.clientX)){var m=document[f];r.pageX=k+(m.scrollLeft||0)-(m.clientLeft||0);r.pageY=r.clientY+(m.scrollTop||0)-(m.clientTop||0)}}if(null==r.which){var t,u,l;s?null!=(t=r.charCode)?r.which=t:null!=(u=r.keyCode)&&(r.which=u):null!==(l=r.button)&&(r.which=1&l?1:2&l?3:4&l?2:0)}r.metaKey=!!r.metaKey;"mousewheel"===p&&(r.wheel=r.wheelDelta);return r}}();pv.fixEvent=function(b){return a.fixEvent(b||window.event)};pv.VmlScene.dispatch=pv.listener(function(d){var c=d.target.$scene;if(c){var b=d.target._events;if("none"===b||pv.Mark.dispatch(d.type,c.scenes,c.index,d)){d.preventDefault();d.stopPropagation()}}});pv.VmlScene.image=function(g){for(var f=g.$g.firstChild,c=0;c<g.length;c++){var d=g[c];if(d.visible){f=this.fill(f,g,c);if(d.image){}else{f=new Image();f.src=d.url;var b=f.style;b.position="absolute";b.top=d.top;b.left=d.left;b.width=d.width;b.height=d.height;b.cursor=d.cursor;b.msInterpolationMode="bicubic"}f=this.append(f,g,c);f=this.stroke(f,g,c)}}return f};pv.VmlScene.label=function(v){for(var u=v.$g.firstChild,t=0,g=v.length;g>t;t++){var l=v[t];if(l.visible){var r=l.textStyle;if(r.opacity&&l.text){var m=l.text.replace(/\s+/g," "),o=a.processFont(l.font),f=a.text_dims(m,o),k=0,j=0;switch(l.textBaseline){case"middle":j=0.1*f.height;break;case"top":j=l.textMargin+0.5*f.height;break;case"bottom":j=-(l.textMargin+0.5*f.height)}switch(l.textAlign){case"left":k=l.textMargin;break;case"right":k=-l.textMargin}var w=l.textAngle;if(w){var d=Math.cos(w),q=Math.sin(w),b=k*d-j*q,h=k*q+j*d;k=b;j=h}var c=l.left+k,n=l.top+j,p={};l.cursor&&(p.cursor=l.cursor);p.fill=a.color(r.color)||"black";a.is64Bit&&(p["fill-opacity"]=0.7);p.x=c;p.y=n;p.rotation=l.textAngle;p.string=m;p.textAlign=l.textAlign;p.font=o;p.textDecoration=l.textDecoration;u=this.expect(u,"text",v,t,p,{display:"block",lineHeight:1,whiteSpace:"nowrap",zoom:1,position:"absolute",cursor:"default",top:n+"px",left:c+"px"});u=this.append(u,v,t)}}}return u};pv.VmlScene.wedge=function(h){for(var j=h.$g.firstChild,r=a.round,g=0,l=h.length;l>g;g++){var t=h[g];if(t.visible){var o=t.fillStyle,q=t.strokeStyle;if(o.opacity||q.opacity){j=this.expect(j,"path",h,g,{"pointer-events":t.events,cursor:t.cursor,transform:"translate("+t.left+","+t.top+")",d:"",fill:o.color,"fill-rule":"evenodd","fill-opacity":o.opacity||null,stroke:q.color,"stroke-opacity":q.opacity||null,"stroke-width":q.opacity?t.lineWidth/this.scale:null,"stroke-linecap":t.lineCap,"stroke-linejoin":t.lineJoin,"stroke-miterlimit":t.strokeMiterLimit,"stroke-dasharray":q.opacity?this.parseDasharray(t):null});var b=j.getElementsByTagName("path")[0];if(!b){b=a.make("path");j.appendChild(b)}var k,f=r(t.innerRadius),c=r(t.outerRadius);if(t.angle>=2*Math.PI){k=f?"AE0,0 "+c+","+c+" 0 23592960AL0,0 "+f+","+f+" 0 23592960":"AE0,0 "+c+","+c+" 0 23592960"}else{var n=Math.round(t.startAngle/Math.PI*11796480),m=Math.round(t.angle/Math.PI*11796480);k=f?"AE 0,0 "+c+","+c+" "+-n+" "+-m+" 0,0 "+f+","+f+" "+-(n+m)+" "+m+"X":"M0,0AE0,0 "+c+","+c+" "+-n+" "+-m+"X"}b.v=k;j=this.append(j,h,g)}}}return j}}();