(function(){var f=YAHOO.util.Dom;var d=Alfresco.util.siteURL;Alfresco.InlineEditMgr=function b(j){Alfresco.InlineEditMgr.superclass.constructor.call(this,"Alfresco.InlineEditMgr",j);YAHOO.Bubbling.on("formContentReady",this.onFormContentReady,this);YAHOO.Bubbling.on("beforeFormRuntimeInit",this.onBeforeFormRuntimeInit,this);return this};YAHOO.extend(Alfresco.InlineEditMgr,Alfresco.component.Base,{options:{nodeRef:null,siteId:null},onFormContentReady:function c(l,j){var k=j[1].buttons.submit;k.set("label",this.msg("button.save"));var m=j[1].buttons.cancel;m.addListener("click",this.onCancelButtonClick,null,this);this.modules.actions=new Alfresco.module.DoclibActions()},onBeforeFormRuntimeInit:function g(k,j){j[1].runtime.setAJAXSubmit(true,{successCallback:{fn:this.onInlineEditSuccess,scope:this},failureCallback:{fn:this.onInlineEditFailure,scope:this}})},onInlineEditSuccess:function e(j){var l=this.options.siteId,k={fileName:j.config.dataObj.prop_cm_name,nodeRef:this.options.nodeRef};this.modules.actions.postActivity(l,"inline-edit","document-details",k,this.bind(function(){this._navigateForward()}))},onInlineEditFailure:function i(j){var k=this.msg("inline-edit-mgr.save.failed");if(j.json.message){k=k+": "+j.json.message}Alfresco.util.PopupManager.displayPrompt({title:this.msg("message.failure"),text:k})},onCancelButtonClick:function a(k,j){this._navigateForward()},_navigateForward:function h(){if(document.referrer){if(document.referrer.match(/documentlibrary([?]|$)/)||document.referrer.match(/repository([?]|$)/)||document.referrer.match(/faceted-search([?]|$)/)){history.go(-1)}else{document.location.href=document.referrer}}else{if(history.length>1){history.go(-1)}else{window.location.href=d("document-details?nodeRef="+new Alfresco.util.NodeRef(this.options.nodeRef).toString())}}}})})();