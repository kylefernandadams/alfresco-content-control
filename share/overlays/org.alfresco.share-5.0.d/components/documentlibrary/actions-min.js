(function(){var R=YAHOO.util.Dom,P=YAHOO.util.Event;var O=Alfresco.util.encodeHTML,I=Alfresco.util.combinePaths,H=Alfresco.util.siteURL,U=Alfresco.util.isValueSet;var i;Alfresco.doclib.Actions={};Alfresco.doclib.Actions.prototype={actionsView:null,onRegisterAction:function z(ae,ad){var af=ad[1];if(af&&U(af.actionName)&&U(af.fn)){this.registerAction(af.actionName,af.fn)}else{Alfresco.logger.error("DL_onRegisterAction: Custom action registion invalid: "+af)}},registerAction:function c(ad,ae){if(U(ad)&&U(ae)){this.constructor.prototype[ad]=ae;return true}return false},renderAction:function T(ae,ah){var ad=Alfresco.constants.URL_RESCONTEXT+"components/documentlibrary/actions/",aj='style="background-image:url('+ad+'{icon}-16.png)" ',ag={link:'<div class="{id}"><a title="{label}" class="simple-link" href="{href}" '+aj+"{target}><span>{label}</span></a></div>",pagelink:'<div class="{id}"><a title="{label}" class="simple-link" href="{pageUrl}" '+aj+"><span>{label}</span></a></div>",javascript:'<div class="{id}" id="{jsfunction}"><a title="{label}" class="action-link" href="#"'+aj+"><span>{label}</span></a></div>"};ah.actionParams[ae.id]=ae.params;var af={id:ae.id,icon:ae.icon,label:O(Alfresco.util.substituteDotNotation(this.msg(ae.label),ah))};if(ae.type==="link"){if(ae.params.href){af.href=Alfresco.util.substituteDotNotation(ae.params.href,ah);af.target=ae.params.target?'target="'+ae.params.target+'"':""}else{Alfresco.logger.warn("Action configuration error: Missing 'href' parameter for actionId: ",ae.id)}}else{if(ae.type==="pagelink"){if(ae.params.page){af.pageUrl=Alfresco.util.substituteDotNotation(ae.params.page,ah);if(ae.params.page.charAt(0)!=="{"){var ai=U(ah.location.site)?ah.location.site.name:null;af.pageUrl=H(af.pageUrl,{site:ai})}}else{Alfresco.logger.warn("Action configuration error: Missing 'page' parameter for actionId: ",ae.id)}}else{if(ae.type==="javascript"){if(ae.params["function"]){af.jsfunction=ae.params["function"]}else{Alfresco.logger.warn("Action configuration error: Missing 'function' parameter for actionId: ",ae.id)}}}}return YAHOO.lang.substitute(ag[ae.type],af)},getActionUrls:function t(aj,ae){var ag=aj.jsNode,am=ag.isLink?ag.linkedNode.nodeRef:ag.nodeRef,am=ag.isLink&&!U(am)?"invalidlink":am,ak=am.toString(),ad=am.uri,ai=ag.contentURL,an=aj.workingCopy||{},af=U(aj.location.site)?aj.location.site.name:null,al=Alfresco.util.bind(function(ao){return Alfresco.util.siteURL(ao,{site:YAHOO.lang.isString(ae)?ae:af})},this),ah={downloadUrl:I(Alfresco.constants.PROXY_URI,ai)+'?a=true" target="_blank',viewUrl:I(Alfresco.constants.PROXY_URI,ai)+'" target="_blank',documentDetailsUrl:al("document-details?nodeRef="+ak),folderDetailsUrl:al("folder-details?nodeRef="+ak),editMetadataUrl:al("edit-metadata?nodeRef="+ak),inlineEditUrl:al("inline-edit?nodeRef="+ak),managePermissionsUrl:al("manage-permissions?nodeRef="+ak),manageTranslationsUrl:al("manage-translations?nodeRef="+ak),workingCopyUrl:al("document-details?nodeRef="+(an.workingCopyNodeRef||ak)),workingCopySourceUrl:al("document-details?nodeRef="+(an.sourceNodeRef||ak)),cloudViewUrl:I(Alfresco.constants.URL_SERVICECONTEXT,"cloud/cloudUrl?nodeRef="+ak)};ah.sourceRepositoryUrl=this.viewInSourceRepositoryURL(aj,ah)+'" target="_blank';return ah},getAction:function ac(ae,ad,ai){var ak=ad.className,ah=Alfresco.util.findInArray(ae.actions,ak,"id")||{};if(ai===false){return ah}else{ah=Alfresco.util.deepCopy(ah);var aj=ah.params||{};for(var af in aj){aj[af]=YAHOO.lang.substitute(aj[af],ae,function ag(am,an,al){return Alfresco.util.findValueByDotNotation(ae,am)})}return ah}},getParentNodeRef:function ab(ae){var ah=null;if(YAHOO.lang.isArray(ae)){try{ah=this.doclistMetadata.parent.nodeRef}catch(ai){ah=null}if(ah===null){for(var ag=1,af=ae.length,ad=true;ag<af&&ad;ag++){ad=(ae[ag].parent.nodeRef==ae[ag-1].parent.nodeRef)}ah=ad?ae[0].parent.nodeRef:this.doclistMetadata.container}}else{ah=ae.parent.nodeRef}return ah},onActionDetails:function J(ag){var am=this,ai=ag.nodeRef,af=ag.jsNode;var ak=function ad(ao,ap){var an='<span class="light">'+O(ag.displayName)+"</span>";Alfresco.util.populateHTML([ap.id+"-dialogTitle",am.msg("edit-details.title",an)]);this.widgets.editMetadata=Alfresco.util.createYUIButton(ap,"editMetadata",null,{type:"link",label:am.msg("edit-details.label.edit-metadata"),href:H("edit-metadata?nodeRef="+ai)})};var ae=YAHOO.lang.substitute(Alfresco.constants.URL_SERVICECONTEXT+"components/form?itemKind={itemKind}&itemId={itemId}&destination={destination}&mode={mode}&submitType={submitType}&formId={formId}&showCancelButton=true",{itemKind:"node",itemId:ai,mode:"edit",submitType:"json",formId:"doclib-simple-metadata"});var al=new Alfresco.module.SimpleDialog(this.id+"-editDetails-"+Alfresco.util.generateDomId());al.setOptions({width:"auto",templateUrl:ae,actionUrl:null,destroyOnHide:true,doBeforeDialogShow:{fn:ak,scope:this},onSuccess:{fn:function ah(ao){var aq="components/documentlibrary/data";if(U(this.options.siteId)){aq+="/site/"+encodeURIComponent(this.options.siteId)}Alfresco.util.Ajax.request({url:I(Alfresco.constants.URL_SERVICECONTEXT,aq,"/node/",af.nodeRef.uri)+"?view="+this.actionsView,successCallback:{fn:function ap(at){var ar=at.json.item;ar.jsNode=new Alfresco.util.Node(at.json.item.node);YAHOO.Bubbling.fire(ar.node.isContainer?"folderRenamed":"fileRenamed",{file:ar});YAHOO.Bubbling.fire("tagRefresh");Alfresco.util.PopupManager.displayMessage({text:this.msg("message.details.success")});this._updateDocList.call(this)},scope:this},failureCallback:{fn:function an(ar){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.details.failure")})},scope:this}})},scope:this},onFailure:{fn:function aj(an){var ao=this.msg("message.details.failure");if(an.json&&an.json.message.indexOf("Failed to persist field 'prop_cm_name'")!==-1){ao=this.msg("message.details.failure.name")}Alfresco.util.PopupManager.displayMessage({text:ao})},scope:this}}).show()},onActionLocate:function Z(ad){var af=ad.jsNode,ah=ad.location.path,ae,ag=U(ad.location.site)?ad.location.site.name:null;if(af.isLink){ae=U(af.linkedNode.properties)?af.linkedNode.properties.name:null;Alfresco.util.PopupManager.displayMessage({text:this.msg("message.actions.failure.locate")})}else{ae=ad.displayName}if(U(this.options.siteId)&&ag!==this.options.siteId){window.location=H((ag===null?"repository":"documentlibrary")+"?file="+encodeURIComponent(ae)+"&path="+encodeURIComponent(ah),{site:ag})}else{this.options.highlightFile=ae;YAHOO.Bubbling.fire("changeFilter",{filterId:"path",filterData:ah})}},onActionDelete:function S(ah){var am=this,af=ah.jsNode,ak=af.isContainer?"folder":"document",ao=ah.displayName,ag=(this.options.syncMode==="CLOUD"),an=0;var ar=this.msg("message.confirm.delete",ao);if(af.hasAspect("sync:syncSetMemberNode")){if(ag){if(af.hasAspect("sync:deleteOnPrem")){ar+=this.msg("actions.synced.cloud."+ak+".delete.on.prem",ao)}else{ar+=this.msg("actions.synced.cloud."+ak+".delete",ao)}}else{ar+=this.msg("actions.synced."+ak+".delete",ao)}}if(this.fullscreen!==undefined&&(this.fullscreen.isWindowOnly||R.hasClass(this.id,"alf-fullscreen"))){an=1000}var ap=undefined;var ae=R.get(this.id);var ad=navigator.userAgent.toLowerCase();if((ad.indexOf("gecko")!=-1||ad.indexOf("safari")!=-1)&&ad.indexOf("chrome")==-1){ap=ae}var al=[{text:this.msg("button.delete"),handler:function aj(){this.destroy();am._onActionDeleteConfirm.call(am,ah)}},{text:this.msg("button.cancel"),handler:function ai(){this.destroy()},isDefault:true}];if(af.hasAspect("sync:syncSetMemberNode")){ar+=this.msg("actions.synced.remove-sync");al.unshift({text:this.msg("button.unsync"),handler:function aq(){var au=ag?false:R.getAttribute("requestDeleteRemote","checked");try{Alfresco.util.Ajax.request({url:Alfresco.constants.PROXY_URI+"enterprise/sync/syncsetmembers/"+ah.jsNode.nodeRef.uri+"?requestDeleteRemote="+au,method:Alfresco.util.Ajax.DELETE,successCallback:{fn:function av(){YAHOO.Bubbling.fire("metadataRefresh");Alfresco.util.PopupManager.displayMessage({text:am.msg("message.unsync.success")})},scope:am},failureMessage:am.msg("message.unsync.failure")})}catch(at){}}})}Alfresco.util.PopupManager.displayPrompt({title:this.msg("actions."+ak+".delete"),text:ar,noEscape:true,buttons:al})},_onActionDeleteConfirm:function X(ag){var ad=ag.jsNode,al=ag.location.path,af=ag.location.file,ae=I(al,af),ai=ag.displayName,aj=ad.nodeRef,ah=this.getParentNodeRef(ag);this.modules.actions.genericAction({success:{activity:{siteId:this.options.siteId,activityType:ad.isContainer?"folder-deleted":"file-deleted",page:"documentlibrary",activityData:{fileName:af,path:al,nodeRef:aj.toString(),parentNodeRef:ah.toString()}},event:{name:ad.isContainer?"folderDeleted":"fileDeleted",obj:{path:ae}},message:this.msg("message.delete.success",ai),callback:{fn:function ak(am,an){if(this.totalRecords){this.totalRecords-=am.json.successCount}},scope:this}},failure:{message:this.msg("message.delete.failure",ai)},webscript:{method:Alfresco.util.Ajax.DELETE,name:"file/node/{nodeRef}",params:{nodeRef:aj.uri}},wait:{message:this.msg("message.multiple-delete.please-wait")}})},onActionEditOffline:function b(ad){Alfresco.logger.error("onActionEditOffline","Abstract implementation not overridden")},onlineEditMimetypes:{"application/msword":"Word.Document","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Word.Document","application/vnd.ms-word.document.macroenabled.12":"Word.Document","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"Word.Document","application/vnd.ms-word.template.macroenabled.12":"Word.Document","application/vnd.ms-powerpoint":"PowerPoint.Slide","application/vnd.openxmlformats-officedocument.presentationml.presentation":"PowerPoint.Slide","application/vnd.ms-powerpoint.presentation.macroenabled.12":"PowerPoint.Slide","application/vnd.openxmlformats-officedocument.presentationml.slideshow":"PowerPoint.Slide","application/vnd.ms-powerpoint.slideshow.macroenabled.12":"PowerPoint.Slide","application/vnd.openxmlformats-officedocument.presentationml.template":"PowerPoint.Slide","application/vnd.ms-powerpoint.template.macroenabled.12":"PowerPoint.Slide","application/vnd.ms-powerpoint.addin.macroenabled.12":"PowerPoint.Slide","application/vnd.openxmlformats-officedocument.presentationml.slide":"PowerPoint.Slide","application/vnd.ms-powerpoint.slide.macroEnabled.12":"PowerPoint.Slide","application/vnd.ms-excel":"Excel.Sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Excel.Sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template":"Excel.Sheet","application/vnd.ms-excel.sheet.macroenabled.12":"Excel.Sheet","application/vnd.ms-excel.template.macroenabled.12":"Excel.Sheet","application/vnd.ms-excel.addin.macroenabled.12":"Excel.Sheet","application/vnd.ms-excel.sheet.binary.macroenabled.12":"Excel.Sheet","application/vnd.visio":"Visio.Drawing"},onActionEditOnline:function m(ad){if(!U(ad.onlineEditUrl)){ad.onlineEditUrl=Alfresco.util.onlineEditUrl(this.doclistMetadata.custom.vtiServer,ad.location)}if(ad.onlineEditUrl.length>260||(encodeURI(ad.onlineEditUrl)).length>260){Alfresco.util.Ajax.request({method:Alfresco.util.Ajax.GET,url:Alfresco.constants.PROXY_URI+"/api/sites/"+ad.location.site.name,successCallback:{fn:function(ae){var ai=ae.json.node.split("/").pop();var ag=ad.nodeRef.split("/").pop();ad.onlineEditUrl=ad.onlineEditUrl.split(ad.location.site.name)[0]+"_IDX_SITE_"+ai+"/_IDX_NODE_"+ag+"/"+ad.displayName;if(ad.onlineEditUrl.length>260){var af=ad.displayName.split(".").pop();var ah=ad.displayName.split(".")[0];var aj=ad.onlineEditUrl.length-260;ad.onlineEditUrl=ad.onlineEditUrl.replace(ad.displayName,ah.substring(0,ah.length-aj-1)+"."+af)}this.actionEditOnlineInternal(ad)},scope:this},failureCallback:{fn:function(ae){this.actionEditOnlineInternal(ad)},scope:this}})}else{this.actionEditOnlineInternal(ad)}},actionEditOnlineInternal:function m(ad){if(ad.onlineEditUrl.length>260){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online.office.path.failure")})}else{if(this._launchOnlineEditor(ad)){YAHOO.Bubbling.fire("metadataRefresh")}else{Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online.office.failure")})}}},_launchOnlineEditor:function C(ah){var ak="SharePoint.OpenDocuments",ae=ah.jsNode,ai=ah.location,am=ae.mimetype,af=null,ag=null,ad={doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",docm:"application/vnd.ms-word.document.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",dotm:"application/vnd.ms-word.template.macroenabled.12",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pptm:"application/vnd.ms-powerpoint.presentation.macroenabled.12",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppsm:"application/vnd.ms-powerpoint.slideshow.macroenabled.12",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",potm:"application/vnd.ms-powerpoint.template.macroenabled.12",ppam:"application/vnd.ms-powerpoint.addin.macroenabled.12",sldx:"application/vnd.openxmlformats-officedocument.presentationml.slide",sldm:"application/vnd.ms-powerpoint.slide.macroEnabled.12",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xltm:"application/vnd.ms-excel.template.macroenabled.12",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12"};if(!Alfresco.util.validLocationForOnlineEdit(ai)){Alfresco.util.PopupManager.displayPrompt({text:this.msg("actions.editOnline.invalid",ai.file)});return true}if(this.onlineEditMimetypes.hasOwnProperty(am)){af=this.onlineEditMimetypes[am]}else{var aj=Alfresco.util.getFileExtension(ah.location.file);if(aj!==null){aj=aj.toLowerCase();if(ad.hasOwnProperty(aj)){am=ad[aj];if(this.onlineEditMimetypes.hasOwnProperty(am)){af=this.onlineEditMimetypes[am]}}}}if(af!==null){if(!U(ah.onlineEditUrl)){ah.onlineEditUrl=Alfresco.util.onlineEditUrl(this.doclistMetadata.custom.vtiServer,ai)}if(YAHOO.env.ua.ie>0){return this._launchOnlineEditorIE(ak,ah,af)}if((YAHOO.env.ua.chrome>0)&&!Alfresco.util.isSharePointPluginInstalled()){var aj=Alfresco.util.getFileExtension(ai.file);if(null!==aj){var al=this.getProtocolForFileExtension(aj.toLowerCase());return this._launchOnlineEditorChrome(al,ah.onlineEditUrl)}}if(Alfresco.util.isSharePointPluginInstalled()){return this._launchOnlineEditorPlugin(ah,af)}else{Alfresco.util.PopupManager.displayPrompt({text:this.msg("actions.editOnline.failure",ai.file)});return false}}return window.open(ah.onlineEditUrl,"_blank")},_launchOnlineEditorChrome:function h(ah,ag){var ad=ah+":ofe%7Cu%7C"+ag;var ai=false;var ae=document.createElement("input");var af=document.body.scrollTop+10;ae.setAttribute("style","z-index: 1000; background-color: rgba(0, 0, 0, 0); border: none; outline: none; position: absolute; left: 10px; top: "+af+"px;");document.getElementsByTagName("body")[0].appendChild(ae);ae.focus();ae.onblur=function(){ai=true};location.href=ad;setTimeout(function(){ae.onblur=null;ae.remove();if(!ai){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online.supported_office_version_required")})}},500)},getProtocolForFileExtension:function(ae){var ad={doc:"ms-word",docx:"ms-word",docm:"ms-word",dot:"ms-word",dotx:"ms-word",dotm:"ms-word",xls:"ms-excel",xlsx:"ms-excel",xlsb:"ms-excel",xlsm:"ms-excel",xlt:"ms-excel",xltx:"ms-excel",xltm:"ms-excel",xlsm:"ms-excel",ppt:"ms-powerpoint",pptx:"ms-powerpoint",pot:"ms-powerpoint",potx:"ms-powerpoint",potm:"ms-powerpoint",pptm:"ms-powerpoint",potm:"ms-powerpoint",pps:"ms-powerpoint",ppsx:"ms-powerpoint",ppam:"ms-powerpoint",ppsm:"ms-powerpoint",sldx:"ms-powerpoint",sldm:"ms-powerpoint"};return ad[ae]},_launchOnlineEditorIE:function K(af,ad,ae){try{if(ae==="Visio.Drawing"){throw ("Visio should be invoked using activeXControl.EditDocument2.")}activeXControl=new ActiveXObject(af+".3");return activeXControl.EditDocument3(window,ad.onlineEditUrl,true,ae)}catch(ah){try{activeXControl=new ActiveXObject(af+".2");return activeXControl.EditDocument2(window,ad.onlineEditUrl,ae)}catch(ai){try{activeXControl=new ActiveXObject(af+".1");return activeXControl.EditDocument(ad.onlineEditUrl,ae)}catch(ag){}}}return false},_launchOnlineEditorPlugin:function g(ae,af){var ag=document.getElementById("SharePointPlugin");if(ag==null&&Alfresco.util.isSharePointPluginInstalled()){var ad=null;if(YAHOO.env.ua.webkit&&Alfresco.util.isBrowserPluginInstalled("application/x-sharepoint-webkit")){ad="application/x-sharepoint-webkit"}else{ad="application/x-sharepoint"}var ak=document.createElement("object");ak.id="SharePointPlugin";ak.type=ad;ak.width=0;ak.height=0;ak.style.setProperty("visibility","hidden","");document.body.appendChild(ak);ag=document.getElementById("SharePointPlugin");if(!ag){return false}}try{if(af==="Visio.Drawing"){throw ("Visio should be invoked using activeXControl.EditDocument2.")}return ag.EditDocument3(window,ae.onlineEditUrl,true,af)}catch(ai){try{return ag.EditDocument2(window,ae.onlineEditUrl,af)}catch(aj){try{return ag.EditDocument(ae.onlineEditUrl,af)}catch(ah){return false}}}},onActionEditOnlineAos:function N(ad){if(!U(ad.onlineEditUrlAos)){ad.onlineEditUrlAos=Alfresco.util.onlineEditUrlAos(this.doclistMetadata.custom.aos,ad)}var ag=Alfresco.util.getFileExtension(ad.location.file);var ae=this.getProtocolForFileExtension(ag);if(ae===undefined){Alfresco.logger.error("onActionEditOnlineAos","No protocol handler available for file extension.");return}var af=new EmbeddedOfficeLauncher();if(af.isIOS()){this._aos_launchOfficeOnIos(af,ae,ad.onlineEditUrlAos);return}if(!af.isWin()&&!af.isMac()){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online-aos.no_supported_environment")});return}if(af.isAvailable()){this._aos_launchOfficeByPlugin(af,ad.onlineEditUrlAos)}else{this._aos_tryToLaunchOfficeByMsProtocolHandler(af,ae,ad.onlineEditUrlAos)}return},_aos_launchOfficeByPlugin:function x(ah,af){var ae,aj;var ag=(ah.isFirefox()||ah.isChrome()||ah.isSafari());if(!ah.EditDocument(af)){if(ah.isControlNotActivated()&&ag){ae=window.setInterval(function(){if(ah.isControlActivated()){window.clearInterval(ae);aj.destroy();window.setTimeout(function(){if(!ah.EditDocument(af)){if(ah.getLastControlResult()!==-2){var ak=ah.getLastControlResult()!==false?" (Error code: "+ah.getLastControlResult()+")":"";Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online-aos.starting_office_failed")+ak})}}else{YAHOO.Bubbling.fire("metadataRefresh")}},50)}},250);var aj=new YAHOO.widget.SimpleDialog("prompt",{close:false,constraintoviewport:true,draggable:false,effect:null,modal:true,visible:true,zIndex:9999});var ai="message.edit-online-aos.plugin_blocked.body.firefox";if(ah.isFirefox()){ai="message.edit-online-aos.plugin_blocked.body.firefox"}else{if(ah.isChrome()){ai="message.edit-online-aos.plugin_blocked.body.chrome"}else{if(ah.isSafari()){ai="message.edit-online-aos.plugin_blocked.body.safari"}}}aj.setHeader(this.msg("message.edit-online-aos.plugin_blocked.caption"));aj.setBody(this.msg(ai));aj.cfg.queueProperty("buttons",[{text:this.msg("message.edit-online-aos.plugin_blocked.button_dismiss"),handler:function(){window.clearInterval(ae);this.destroy()},isDefault:true}]);aj.render(document.body);aj.center();aj.show()}else{if(ah.getLastControlResult()!==-2){var ad=ah.getLastControlResult()!==false?" (Error code: "+ah.getLastControlResult()+")":"";Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online-aos.starting_office_failed")+ad})}}}else{YAHOO.Bubbling.fire("metadataRefresh")}},_aos_tryToLaunchOfficeByMsProtocolHandler:function V(aj,ah,ag){var ad=ah+":ofe%7Cu%7C"+ag;var ai=false;var ae=document.createElement("input");var af=document.body.scrollTop+10;ae.setAttribute("style","z-index: 1000; background-color: rgba(0, 0, 0, 0); border: none; outline: none; position: absolute; left: 10px; top: "+af+"px;");document.getElementsByTagName("body")[0].appendChild(ae);ae.focus();ae.onblur=function(){ai=true};location.href=ad;setTimeout(function(){ae.onblur=null;ae.remove();if(!ai){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-online-aos.supported_office_version_required")})}},500)},_aos_launchOfficeOnIos:function v(ah,af,ae){var ad=af+":ofe%7Cu%7C"+ah.encodeUrl(ae);var ag=document.createElement("iframe");ag.setAttribute("style","display: none; height: 0; width: 0;");document.getElementsByTagName("body")[0].appendChild(ag);ag.src=ad},getProtocolForFileExtension:function(ae){var ad={doc:"ms-word",docx:"ms-word",docm:"ms-word",dot:"ms-word",dotx:"ms-word",dotm:"ms-word",xls:"ms-excel",xlsx:"ms-excel",xlsb:"ms-excel",xlsm:"ms-excel",xlt:"ms-excel",xltx:"ms-excel",xltm:"ms-excel",xlsm:"ms-excel",ppt:"ms-powerpoint",pptx:"ms-powerpoint",pot:"ms-powerpoint",potx:"ms-powerpoint",potm:"ms-powerpoint",pptm:"ms-powerpoint",potm:"ms-powerpoint",pps:"ms-powerpoint",ppsx:"ms-powerpoint",ppam:"ms-powerpoint",ppsm:"ms-powerpoint",sldx:"ms-powerpoint",sldm:"ms-powerpoint"};return ad[ae]},onActionSimpleRepoAction:function e(ai,ae){if(ae.title.indexOf("_deactivated")==-1){var ag=this.getAction(ai,ae).params,am=ai.displayName,al=["function","action","success","successMessage","failure","failureMessage"],aj={};for(var ad in ag){if(ag.hasOwnProperty(ad)&&!Alfresco.util.arrayContains(al,ad)){aj[ad]=ag[ad]}}var ak=ae.title;ae.title=ae.title+"_deactivated";var af={success:{event:{name:"metadataRefresh",obj:ai}},failure:{message:this.msg(ag.failureMessage,am),fn:function ah(){ae.title=ak},scope:this},webscript:{method:Alfresco.util.Ajax.POST,stem:Alfresco.constants.PROXY_URI+"api/",name:"actionQueue"},config:{requestContentType:Alfresco.util.Ajax.JSON,dataObj:{actionedUponNode:ai.nodeRef,actionDefinitionName:ag.action,parameterValues:aj}}};if(YAHOO.lang.isFunction(this[ag.success])){af.success.callback={fn:this[ag.success],obj:ai,scope:this}}if(ag.successMessage){af.success.message=this.msg(ag.successMessage,am)}if(YAHOO.lang.isFunction(this[ag.failure])){af.failure.callback={fn:this[ag.failure],obj:ai,scope:this}}if(ag.failureMessage){af.failure.message=this.msg(ag.failureMessage,am)}this.modules.actions.genericAction(af)}},onActionFormDialog:function o(ae,ad){var af=this.generateConfigForFormDialogAction(ae,ad);Alfresco.util.PopupManager.displayForm(af)},onActionFormDialogWithSubmitDisable:function y(ae,ad){var af=this.generateConfigForFormDialogAction(ae,ad);af.properties.disableSubmitButton=true;Alfresco.util.PopupManager.displayForm(af)},generateConfigForFormDialogAction:function D(af,ad){var ah=this.getAction(af,ad),aj=ah.params,ag={title:this.msg(ah.label)},ae=af.displayName;delete aj["function"];var ai=aj.success;delete aj.success;ag.success={fn:function(ak,al){if(YAHOO.lang.isFunction(this[ai])){this[ai].call(this,ak,al)}YAHOO.Bubbling.fire("metadataRefresh",al)},obj:af,scope:this};if(aj.successMessage){ag.successMessage=this.msg(aj.successMessage,ae);delete aj.successMessage}if(YAHOO.lang.isFunction(this[aj.failure])){ag.failure={fn:this[aj.failure],obj:af,scope:this};delete aj.failure}if(aj.failureMessage){ag.failureMessage=this.msg(aj.failureMessage,ae);delete aj.failureMessage}ag.properties=aj;return ag},onActionUploadNewVersion:function l(af){var ae=af.jsNode,aj=af.displayName,ak=ae.nodeRef,ag=af.version;if(!this.fileUpload){this.fileUpload=Alfresco.getFileUploadInstance()}var al=this.msg("label.filter-description",aj),ah="*";if(aj&&new RegExp(/[^\.]+\.[^\.]+/).exec(aj)){ah="*"+aj.substring(aj.lastIndexOf("."))}if(af.workingCopy&&af.workingCopy.workingCopyVersion){ag=af.workingCopy.workingCopyVersion}var ai=0;if(this.fullscreen!==undefined&&(this.fullscreen.isWindowOnly||R.hasClass(this.id,"alf-fullscreen"))){ai=1000}var ad={updateNodeRef:ak.toString(),updateFilename:aj,updateVersion:ag,overwrite:true,filter:[{description:al,extensions:ah}],mode:this.fileUpload.MODE_SINGLE_UPDATE,onFileUploadComplete:{fn:this.onNewVersionUploadComplete,scope:this}};this.fileUpload.options.zIndex=ai;if(U(this.options.siteId)){ad.siteId=this.options.siteId;ad.containerId=this.options.containerId}this.fileUpload.show(ad)},_uploadComplete:function Q(ad,ah){var ai=ad.successful.length,ae,ag;if(ai>0){if(ai<(this.options.groupActivitiesAt||5)){for(var af=0;af<ai;af++){ag=ad.successful[af];ae={fileName:ag.fileName,nodeRef:ag.nodeRef};this.modules.actions.postActivity(this.options.siteId,"file-"+ah,"document-details",ae)}}else{ae={fileCount:ai,path:this.currentPath,parentNodeRef:this.doclistMetadata.parent.nodeRef};this.modules.actions.postActivity(this.options.siteId,"files-"+ah,"documentlibrary",ae)}}},onFileUploadComplete:function q(ad){this._uploadComplete(ad,"added")},onNewVersionUploadComplete:function A(ad){this._uploadComplete(ad,"updated")},onActionCancelEditing:function k(ae){var ad=ae.displayName;this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},message:this.msg("message.edit-cancel.success",ad)},failure:{message:this.msg("message.edit-cancel.failure",ad)},webscript:{method:Alfresco.util.Ajax.POST,name:"cancel-checkout/node/{nodeRef}",params:{nodeRef:ae.jsNode.nodeRef.uri}}});YAHOO.Bubbling.fire("editingCanceled",{record:ae})},onActionUnlockDocument:function aa(ae){var ad=ae.displayName;this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},message:this.msg("message.unlock-document.success",ad)},failure:{message:this.msg("message.unlock-document.failure",ad)},webscript:{method:Alfresco.util.Ajax.POST,name:"unlock-document/node/{nodeRef}",params:{nodeRef:ae.jsNode.nodeRef.uri}}})},onActionCopyTo:function j(ad){this._copyMoveTo("copy",ad)},onActionMoveTo:function f(ad){this._copyMoveTo("move",ad)},_copyMoveTo:function G(ah,af){if(!ah in {copy:true,move:true}){throw new Error("'"+ah+"' is not a valid Copy/Move to mode.")}if(!this.modules.copyMoveTo){this.modules.copyMoveTo=new Alfresco.module.DoclibCopyMoveTo(this.id+"-copyMoveTo")}var ag=Alfresco.module.DoclibGlobalFolder;var ae=[ag.VIEW_MODE_RECENT_SITES,ag.VIEW_MODE_FAVOURITE_SITES,ag.VIEW_MODE_SITE,ag.VIEW_MODE_SHARED];if(this.options.repositoryBrowsing===true){ae.push(ag.VIEW_MODE_REPOSITORY)}ae.push(ag.VIEW_MODE_USERHOME);var ai=0;if(this.fullscreen!==undefined&&(this.fullscreen.isWindowOnly||R.hasClass(this.id,"alf-fullscreen"))){ai=1000}var ad=af[0]?af[0].location.repoPath:af.location.repoPath;this.modules.copyMoveTo.setOptions({allowedViewModes:ae,mode:ah,siteId:this.options.siteId,containerId:this.options.containerId,path:this.options.repositoryBrowsing?ad:this.currentPath,files:af,rootNode:this.options.repositoryBrowsing?this.modules.copyMoveTo.options.rootNode:this.options.rootNode,parentId:this.getParentNodeRef(af),zIndex:ai}).showDialog()},onActionAssignWorkflow:function d(ae){var ai="",ad=this.getParentNodeRef(ae);if(YAHOO.lang.isArray(ae)){for(var ag=0,af=ae.length;ag<af;ag++){ai+=(ag===0?"":",")+ae[ag].nodeRef}}else{ai=ae.nodeRef}var ah={selectedItems:ai};if(ad){ah.destination=ad}Alfresco.util.navigateTo(H("start-workflow"),"POST",ah)},onActionManagePermissions:function M(ad){if(!this.modules.permissions){this.modules.permissions=new Alfresco.module.DoclibPermissions(this.id+"-permissions")}this.modules.permissions.setOptions({siteId:this.options.siteId,containerId:this.options.containerId,path:this.currentPath,files:ad}).showDialog()},onActionManageAspects:function s(ad){if(!this.modules.aspects){this.modules.aspects=new Alfresco.module.DoclibAspects(this.id+"-aspects")}this.modules.aspects.setOptions({file:ad}).show()},onActionChangeType:function r(ah){var ad=ah.jsNode,ai=ad.type,ak=ah.displayName,ae=Alfresco.constants.PROXY_URI+I("slingshot/doclib/type/node",ad.nodeRef.uri);var al=function ag(an){an.addValidation(this.id+"-changeType-type",function am(au,ap,at,ar,ao,aq){return au.options[au.selectedIndex].value!=="-"},null,"change",null,{validationType:"mandatory"})};this.modules.changeType=new Alfresco.module.SimpleDialog(this.id+"-changeType").setOptions({width:"30em",templateUrl:Alfresco.constants.URL_SERVICECONTEXT+"modules/documentlibrary/change-type?currentType="+encodeURIComponent(ai),actionUrl:ae,doSetupFormsValidation:{fn:al,scope:this},firstFocus:this.id+"-changeType-type",onSuccess:{fn:function aj(am){YAHOO.Bubbling.fire("metadataRefresh",{highlightFile:ak});Alfresco.util.PopupManager.displayMessage({text:this.msg("message.change-type.success",ak)})},scope:this},onFailure:{fn:function af(am){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.change-type.failure",ak)})},scope:this}});this.modules.changeType.show()},viewInSourceRepositoryURL:function p(af,ah){var ag=af.node,ae=af.location.repositoryId,ad=this.options.replicationUrlMapping,ai;if(!ae||!ad||!ad[ae]){return"#"}ai=ag.isContainer?ah.folderDetailsUrl:ah.documentDetailsUrl;ai=ai.substring(Alfresco.constants.URL_CONTEXT.length);return I(ad[ae],"/",ai)},onActionCloudSync:function W(ad){if(!i){i=new Alfresco.module.DoclibCloudFolder(this.id+"-cloud-folder");var af=this;YAHOO.Bubbling.on("folderSelected",function ag(aj,ai){this.updateSyncOptions();Alfresco.util.Ajax.jsonPost({url:Alfresco.constants.PROXY_URI+"enterprise/sync/syncsetdefinitions",dataObj:YAHOO.lang.merge(this.options.syncOptions,{memberNodeRefs:af.getMemberNodeRefs(this.options.files),remoteTenantId:this.options.targetNetwork,targetFolderNodeRef:ai[1].selectedFolder.nodeRef}),successCallback:{fn:function ak(){YAHOO.Bubbling.fire("metadataRefresh");Alfresco.util.PopupManager.displayMessage({text:this.msg("message.sync.success")})},scope:this},failureMessage:this.msg("message.sync.failure")})},i)}else{var ah=i.widgets.optionInputs;if(ah){for(var ae=0;ae<ah.length;ae++){ah[ae].checked=ah[ae].defaultChecked}}}if(!this.modules.cloudAuth){this.modules.cloudAuth=new Alfresco.module.CloudAuth(this.id+"cloudAuth")}i.setOptions({files:ad});this.modules.cloudAuth.setOptions({authCallback:i.showDialog,authCallbackContext:i}).checkAuth()},onActionCloudUnsync:function F(af){var ak=this,aj=af.jsNode.isContainer?"folder":"document",ae=af.displayName,ai=(this.options.syncMode==="CLOUD"),ad=ai?"":'<div><input type="checkbox" id="requestDeleteRemote" class="requestDeleteRemote-checkBox"><span class="requestDeleteRemote-text">'+this.msg("sync.remove."+aj+".from.cloud",ae)+"</span></div>";Alfresco.util.PopupManager.displayPrompt({title:this.msg("actions."+aj+".cloud-unsync"),noEscape:true,text:this.msg("message.unsync.confirm",ae)+ad,buttons:[{text:this.msg("button.unsync"),handler:function ag(){var al=ai?false:R.getAttribute("requestDeleteRemote","checked");this.destroy();Alfresco.util.Ajax.request({url:Alfresco.constants.PROXY_URI+"enterprise/sync/syncsetmembers/"+af.jsNode.nodeRef.uri+"?requestDeleteRemote="+al,method:Alfresco.util.Ajax.DELETE,successCallback:{fn:function am(){YAHOO.Bubbling.fire("metadataRefresh");Alfresco.util.PopupManager.displayMessage({text:ak.msg("message.unsync.success")})},scope:ak},failureMessage:ak.msg("message.unsync.failure")})}},{text:this.msg("button.cancel"),handler:function ah(){this.destroy()},isDefault:true}]})},onCloudSyncIndicatorAction:function B(ad,ah){var af=new Alfresco.util.createInfoBalloon(this.widgets.dataTable.getTrEl(ah),{text:this.msg("label.loading"),width:"455px"});af.show();Alfresco.util.Ajax.request({url:Alfresco.constants.PROXY_URI+"slingshot/doclib2/node/"+ad.nodeRef.replace("://","/"),successCallback:{fn:function ag(aj){var ak=this,ai={showTitle:true,showRequestSyncButton:true,showUnsyncButton:true,showMoreInfoLink:true};Alfresco.util.getSyncStatus(this,ad,aj.json,ai,function(am){if(am!=null){af.html(am.html);af.requestsync=Alfresco.util.createYUIButton(ak,"button-requestsyn",function(){ak.onActionCloudSyncRequest(ad);af.hide()},{id:ak.id});if(!am.showRequestSyncButton&&af.requestsync!=null){af.requestsync.setStyle("display","none")}af.unsync=Alfresco.util.createYUIButton(ak,"button-unsync",function(){ak.onActionCloudUnsync(ad);af.hide()},{id:ak.id});if(!am.showUnsyncButton&&af.unsync!=null){af.unsync.setStyle("display","none")}var al=af.content;Alfresco.util.syncClickOnShowDetailsLinkEvent(ak,al);Alfresco.util.syncClickOnHideLinkEvent(ak,al);Alfresco.util.syncClickOnTransientErrorShowDetailsLinkEvent(ak,al);Alfresco.util.syncClickOnTransientErrorHideLinkEvent(ak,al)}else{af.hide()}})},scope:this},failureCallback:{fn:function ae(ai){Alfresco.util.PopupManager.displayMessage({text:this.msg("sync.unable.get.details")})},scope:this}})},onActionCloudSyncRequest:function w(ad,af){Alfresco.util.Ajax.jsonPost({url:Alfresco.constants.PROXY_URI+"enterprise/sync/syncrequest",dataObj:{memberNodeRefs:this.getMemberNodeRefs(ad)},successCallback:{fn:function ae(){YAHOO.Bubbling.fire("metadataRefresh");Alfresco.util.PopupManager.displayMessage({text:this.msg("message.request.sync.success")})},scope:this},failureMessage:this.msg("message.request.sync.failure")})},getMemberNodeRefs:function a(ad){var af=new Array();if(YAHOO.lang.isArray(ad)){for(var ae in ad){af.push(ad[ae].nodeRef)}}else{af.push(ad.nodeRef)}return af},onCloudSyncFailedIndicatorAction:function E(ad,ae){this.onCloudSyncIndicatorAction(ad,ae)},onCloudIndirectSyncIndicatorAction:function Y(ad,ae){this.onCloudSyncIndicatorAction(ad,ae)},onCloudIndirectSyncFailedIndicatorAction:function L(ad,ae){this.onCloudSyncIndicatorAction(ad,ae)},onActionFolderDownload:function u(ad){var ae=Alfresco.getArchiveAndDownloadInstance(),af={nodesToArchive:[{nodeRef:ad.nodeRef}],archiveName:ad.fileName};ae.show(af)},onActionDownload:function n(ad){var ae=Alfresco.getArchiveAndDownloadInstance(),af={nodesToArchive:[]};if(ad.length==1){af.nodesToArchive.push({nodeRef:ad[0].nodeRef});af.archiveName=ad[0].fileName}else{for(var ag=0;ag<ad.length;ag++){af.nodesToArchive.push({nodeRef:ad[ag].nodeRef})}}ae.show(af)}}})();