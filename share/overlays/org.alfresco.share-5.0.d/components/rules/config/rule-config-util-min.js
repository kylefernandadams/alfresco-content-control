(function(){var g=YAHOO.util.Dom;var e=Alfresco.util.encodeHTML,f=Alfresco.util.combinePaths;Alfresco.RuleConfigUtil={};Alfresco.RuleConfigUtil.prototype={listeningForReadyRuleConfigs:false,ruleConfigs:{},loadRuleConfigs:function i(){if(!this.modules.ruleConfigs){this.modules.ruleConfigs={}}if(!this.listeningForReadyRuleConfigs){YAHOO.Bubbling.on("ruleConfigReady",this.onRuleConfigReady,this)}this._loadRuleConfigs([{component:"components/rules/config/type",name:"ruleConfigType",dataObj:{}},{component:"components/rules/config/condition",name:"ruleConfigIfCondition",dataObj:{mode:"if"}},{component:"components/rules/config/condition",name:"ruleConfigUnlessCondition",dataObj:{mode:"unless"}},{component:"components/rules/config/action",name:"ruleConfigAction",dataObj:{}}])},_loadRuleConfigs:function c(m){if(m&&m.length>0){var l=m[0],k=this.id+"-"+l.name,j=YAHOO.lang.merge({htmlid:k,site:this.options.siteId},l.dataObj);this.ruleConfigs[k]=false;Alfresco.util.Ajax.request({url:Alfresco.constants.URL_SERVICECONTEXT+l.component,dataObj:j,successCallback:{fn:function(n){g.get(this.id+"-"+l.name).innerHTML=n.serverResponse.responseText;m.splice(0,1);this._loadRuleConfigs(m)},scope:this},execScripts:true})}else{this.onRuleConfigsLoaded()}},onRuleConfigReady:function h(l,k){var j=k[1].eventGroup,m=j.id;if(YAHOO.lang.isBoolean(this.ruleConfigs[m])){this.ruleConfigs[m]=j}if(!this.ruleConfigs[this.id+"-ruleConfigType"]||!this.ruleConfigs[this.id+"-ruleConfigIfCondition"]||!this.ruleConfigs[this.id+"-ruleConfigUnlessCondition"]||!this.ruleConfigs[this.id+"-ruleConfigAction"]){return}this.onRuleConfigsReady()},onRuleConfigsReady:function b(){},onRuleConfigsLoaded:function d(){},displayRuleConfigs:function a(p,o,j){var l=null,t=[];var r=[];for(var n=0,q=p.ruleType.length;n<q;n++){r.push({name:p.ruleType[n]})}l=this.ruleConfigs[this.id+"-ruleConfigType"];l.setOptions({siteId:this.options.siteId,form:j,mode:o});l.displayRuleConfigs(r);t.push(r.length);var s=[],m=[],k;for(n=0,q=p.action.conditions?p.action.conditions.length:0;n<q;n++){k=p.action.conditions[n];if(k.invertCondition){m.push(k)}else{s.push(k)}}l=this.ruleConfigs[this.id+"-ruleConfigIfCondition"];l.setOptions({siteId:this.options.siteId,form:j,mode:o,ruleConfigDefinitionKey:"conditionDefinitionName"});l.displayRuleConfigs(s);t.push(s.length);l=this.ruleConfigs[this.id+"-ruleConfigUnlessCondition"];l.setOptions({siteId:this.options.siteId,form:j,mode:o,ruleConfigDefinitionKey:"conditionDefinitionName"});l.displayRuleConfigs(m);t.push(m.length);l=this.ruleConfigs[this.id+"-ruleConfigAction"];l.setOptions({siteId:this.options.siteId,form:j,mode:o,ruleConfigDefinitionKey:"actionDefinitionName"});l.displayRuleConfigs(p.action.actions);t.push(p.action.actions.length);return t}}})();