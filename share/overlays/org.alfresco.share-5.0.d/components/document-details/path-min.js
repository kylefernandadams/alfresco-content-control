(function(){var f=YAHOO.util.Dom;var a=Alfresco.util.encodeHTML,g=Alfresco.util.combinePaths,h=Alfresco.util.siteURL,e=Alfresco.util.userProfileLink;Alfresco.component.Path=function(i){Alfresco.component.Path.superclass.constructor.call(this,"Alfresco.component.Path",i);YAHOO.Bubbling.on("documentDetailsAvailable",this.onDocumentDetailsAvailable,this);YAHOO.Bubbling.on("folderDetailsAvailable",this.onFolderDetailsAvailable,this);YAHOO.Bubbling.on("nodeDetailsAvailable",this.onNodeDetailsAvailable,this);return this};YAHOO.extend(Alfresco.component.Path,Alfresco.component.Base,{options:{rootPage:"documentlibrary",rootLabelId:"path.documents",showIconType:true},onDocumentDetailsAvailable:function c(p,q){var n=q[1].documentDetails,u,r=this.options.rootPage,m="",j=[],i;var v=n.location.path;if(v.length<2){u='<span class="path-link"><a href="'+h(r+"?file="+encodeURIComponent(n.fileName))+'">'+this.msg(this.options.rootLabelId)+"</a></span>"}else{u='<span class="path-link"><a href="'+h(r)+'">'+this.msg(this.options.rootLabelId)+"</a></span>";j=v.substring(1,v.length).split("/");if(j.length>0){u+='<span class="separator"> &gt; </span>'}for(var t=0,s=j.length;t<s;t++){m+="/"+j[t];i=r+(s-t<2?"?file="+encodeURIComponent(n.fileName)+"&path=":"?path=")+encodeURIComponent(m);u+='<span class="path-link folder"><a href="'+h(i)+'">'+a(j[t])+"</a></span>";if(s-t>1){u+='<span class="separator"> &gt; </span>'}}}f.setStyle(this.id+"-defaultPath","display","none");f.get(this.id+"-path").innerHTML=u;f.addClass(this.id+"-status","hidden");if(n.custom&&(n.custom.isWorkingCopy||n.custom.hasWorkingCopy)){var k,o;if(n.lockedByUser&&n.lockedByUser!==""){var l=e(n.lockedByUser,n.lockedBy,'class="theme-color-1"');if(n.lockedByUser===Alfresco.constants.USERNAME){o=n.actionSet==="lockOwner"?"lock-owner":"editing";k=this.msg("banner."+o)}else{o="locked";k=this.msg("banner.locked",l)}}if(k){f.get(this.id+"-status").innerHTML='<span class="'+a(o)+'">'+k+"</span>";f.removeClass(this.id+"-status","hidden")}YAHOO.Bubbling.fire("recalculatePreviewLayout")}},onFolderDetailsAvailable:function b(l,n){var m=n[1].folderDetails,r="",o=this.options.rootPage,k="/",j=[],i;var s=m.location.path;if(s=="/"&&m.location.file.length>0){r='<span class="path-link"><a href="'+h(o+"?file="+encodeURIComponent(m.fileName))+'">'+this.msg(this.options.rootLabelId)+"</a></span>"}else{r='<span class="path-link"><a href="'+h(o)+'">'+this.msg(this.options.rootLabelId)+"</a></span>"}s=g(s,m.location.file);if(s.length>1){j=s.substring(1,s.length).split("/");r+='<span class="separator"> &gt; </span>';for(var q=0,p=j.length;q<p;q++){k+=j[q];i=o+(p-q==2?"?file="+encodeURIComponent(m.fileName)+"&path=":"?path=")+encodeURIComponent(k);r+='<span class="path-link '+(p-q==1?"self":"folder")+'"><a href="'+h(i)+'">'+a(j[q])+"</a></span>";if(p-q>1){r+='<span class="separator"> &gt; </span>';k+="/"}}}f.setStyle(this.id+"-defaultPath","display","none");f.get(this.id+"-path").innerHTML=r;if(this.options.showIconType){Alfresco.util.populateHTML([this.id+"-iconType",YAHOO.lang.substitute('<img src="{iconContext}{icon}-48.png" width="48" height="48" /><span class="type">{type}</span>',{iconContext:Alfresco.constants.URL_RESCONTEXT+"components/documentlibrary/images/",icon:m.type,type:this.msg("type."+m.type,a(m.displayName))})])}},onNodeDetailsAvailable:function d(l,k){var j=k[1].nodeDetails,i=k;if(j.isFolder){i[1].folderDetails=j;this.onFolderDetailsAvailable(l,i)}else{i[1].documentDetails=j;this.onDocumentDetailsAvailable(l,i)}}})})();