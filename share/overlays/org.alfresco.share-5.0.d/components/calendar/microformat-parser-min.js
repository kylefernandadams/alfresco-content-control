function microformatParser(b){var j=YAHOO.util.Dom;var g=YAHOO.util.Event;var f=YAHOO.lang;var y={registry:{},renderers:{},parsers:{},refs:{},parsedData:{}};var h=b.srcNode;delete b.srcNode;var v=b.ufSpec||{};delete b.ufSpec;if(!b.data){for(var s=0;s<v.fields.length;s++){y.registry[v.fields[s]]=null}}else{if(b.data){for(var u in b.data){if((u!=="parsers")||(u!=="renderers")){if(u in v.fields){y.registry[u]=b[u]}}}}}if(b.parsers){for(var m in b.parsers){k(v.name+"."+v.root+"."+m,b.parsers[m])}}if(b.renderers){for(var l in b.renderers){y.renderers[m]=b.renderers[m]}}var w=function(i){switch(i.nodeName.toLowerCase()){case"span":return i.title||i.innerHTML;case"img":return(i.alt)}while(i&&i.hasChildNodes()){i=i.firstChild}return i.nodeValue};var t=function(i,p){if(i.innerText){i.innerText=p}else{while(i.hasChildNodes()){i=i.firstChild;if(i.nodeType==3){i.nodeValue=p}else{return t(i,p)}}}};var n=function(i,p){if(YAHOO.lang.isString(p)){switch(i.nodeName.toLowerCase()){case"span":if(i.title){i.title=p}else{i.innerHTML=p}return;case"img":i.alt=p;return}}return t(i,p)};var c=function(p){var i=y.parsers[p]||v.parsers[p];y.parsedData[p]=(i)?i(y.registry[p]):y.registry[p];return null};var x=function(p,r,i){p[r]=i;c(p,r)};var a=function(i){return y.parsers[i]};function k(i,p){y.parsers[i]=p}function q(i,p){y.renderers[i]=p}var e=function(){for(var p=0;p<v.fields.length;p++){var A=v.fields[p];var r=y.refs[A];if(r){n(r,y.registry[A])}var z=y.renderers[A]||v.renderers[A];if(z){z(r,y.parsedData[A])}}};function o(r,i){if(r){for(var p in r){if(p in y.registry){y.registry[p]=r[p];c(p)}}}if(i&&i===true){e()}}function d(r){var r=r||h;var D=v.root;var C=v.fields;var A=C.length;if(j.hasClass(r,v.root)){y.refs={};y.parsedData={};var E={};y.refs.parentElement=r;for(var z=0;z<A;z++){var p=C[z];var i=j.getElementsByClassName(p,null,r);if(i&&i[0]){i=i[0];y.refs[p]=i;var B=w(i);if(B){E[p]=B}}}o(E,false);return y.registry}return null}return{parse:function(i){return d(i)},render:function(){return e()},update:function(p,i){return o(p,i)},getType:function(){return v.name},addParser:function(i,p){return k(i,p)},addRenderer:function(i,p){return q(i,p)},getAll:function(){return y},get:function(p,i){var i=i||false;if(i){return y.parsedData[p]||""}else{return y.registry[p]||""}}}};