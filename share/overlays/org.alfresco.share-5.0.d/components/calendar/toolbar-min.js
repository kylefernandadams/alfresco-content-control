(function(){var d=YAHOO.util.Dom,b=YAHOO.util.Event,c=YAHOO.util.Element;var a=Alfresco.util.encodeHTML;Alfresco.CalendarToolbar=function(e,f,g){this.name="Alfresco.CalendarToolbar";this.id=e;this.enabledViews=f;this.defaultView=g;this.navButtonGroup=null;this.nextButton=null;this.prevButton=null;this.todayButton=null;Alfresco.util.YUILoaderHelper.require(["button","container","connection"],this.onComponentsLoaded,this);Alfresco.util.ComponentManager.register(this);return this};Alfresco.CalendarToolbar.prototype={setSiteId:function(e){this.siteId=e;return this},setMessages:function(e){Alfresco.util.addMessages(e,this.name);return this},onComponentsLoaded:function(){b.onContentReady(this.id,this.init,this,true)},init:function(){if(d.get(this.id+"-addEvent-button")){Alfresco.util.createYUIButton(this,"addEvent-button",this.onButtonClick)}Alfresco.util.createYUIButton(this,"publishEvents-button",null,{type:"link"});this.nextButton=Alfresco.util.createYUIButton(this,"next-button",this.onNextNav);this.nextButton.addClass("next-button");this.prevButton=Alfresco.util.createYUIButton(this,"prev-button",this.onPrevNav);this.prevButton.addClass("prev-button");this.todayButton=Alfresco.util.createYUIButton(this,"today-button",this.onTodayNav);this.workHoursButton=Alfresco.util.createYUIButton(this,"workHours-button",this.onToggleWorkHours,{type:"checkbox",checked:false});this.workHoursButton.set("title",Alfresco.util.message(this.workHoursButton.get("checked")?"button.work-hours.all":"button.work-hours.working","Alfresco.CalendarToolbar"));this.navButtonGroup=new YAHOO.widget.ButtonGroup(this.id+"-navigation");if(typeof(this.navButtonGroup)!="undefined"&&this.navButtonGroup._buttons!=null){var g=window.location.hash,e=g.substring(g.indexOf("view=")+5).split("&")[0]||Alfresco.util.getQueryStringParameter("view")||this.defaultView;for(var f=0;f<this.navButtonGroup._buttons.length;f++){if(this.navButtonGroup._buttons[f]._button.id.match(e)){this.navButtonGroup.check(f);this.disableButtons(f);break}}this.navButtonGroup.on("checkedButtonChange",this.onNavigation,this.navButtonGroup,this)}},onNextNav:function(f){this._fireEvent("nextNav")},onPrevNav:function(f){this._fireEvent("prevNav")},onTodayNav:function(f){this._fireEvent("todayNav")},onToggleWorkHours:function(f){this.workHoursButton.set("title",Alfresco.util.message(this.workHoursButton.get("checked")?"button.work-hours.all":"button.work-hours.working","Alfresco.CalendarToolbar"));this._fireEvent("toggleWorkHours")},onNavigation:function(f){this.disableButtons(f.newValue.index);YAHOO.Bubbling.fire("viewChanged",{activeView:f.newValue.index})},disableButtons:function(e){var f=this.navButtonGroup.getButtons()[e];if(this.todayButton!=null){if(f.get("label")===Alfresco.util.message("label.agenda","Alfresco.CalendarView")){this.todayButton.set("disabled",true);this.nextButton.set("disabled",true);this.prevButton.set("disabled",true)}else{this.todayButton.set("disabled",false);this.nextButton.set("disabled",false);this.prevButton.set("disabled",false)}if(f.get("label")===Alfresco.util.message("label.month","Alfresco.CalendarView")||f.get("label")===Alfresco.util.message("label.agenda","Alfresco.CalendarView")){this.workHoursButton.set("disabled",true)}else{this.workHoursButton.set("disabled",false)}}},_fireEvent:function(e){YAHOO.Bubbling.fire(e,{source:this})},onButtonClick:function(g){var f=Alfresco.util.ComponentManager.findFirst("Alfresco.CalendarView");if(f){f.showAddDialog()}}}})();