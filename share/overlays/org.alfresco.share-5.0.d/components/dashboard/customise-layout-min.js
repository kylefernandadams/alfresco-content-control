(function(){var f=YAHOO.util.Dom,c=YAHOO.util.Event;Alfresco.CustomiseLayout=function(i){Alfresco.CustomiseLayout.superclass.constructor.call(this,"Alfresco.CustomiseLayout",i,["button","container","datasource"]);return this};YAHOO.extend(Alfresco.CustomiseLayout,Alfresco.component.Base,{widgets:{},options:{currentLayout:{},layouts:{}},setOptions:function e(i){this.options=YAHOO.lang.merge(this.options,i);return this},setMessages:function b(i){Alfresco.util.addMessages(i,this.name);return this},onReady:function h(){if(this.id===null){return}this.widgets.layoutLiElements=[];this.widgets.layoutUlElement=f.get(this.id+"-layout-ul");this.widgets.changeButton=Alfresco.util.createYUIButton(this,"change-button",this.onChangeButtonClick);this.widgets.cancelButton=Alfresco.util.createYUIButton(this,"cancel-button",this.onCancelButtonClick);this.widgets.selectButtons=[];for(var i in this.options.layouts){var j=f.get(this.id+"-layout-li-"+i);this.widgets.layoutLiElements[i]=j;this.widgets.selectButtons[i]=Alfresco.util.createYUIButton(this,"select-button-"+i,function(m,l){var n=l.get("id");var k=n.substring((this.id+"-select-button-").length);this.onSelectLayoutClick(k)});c.addListener(this.id+"-select-img-"+i,"click",function(k,l){l.thisComponent.onSelectLayoutClick(l.selectedLayoutId)},{selectedLayoutId:i,thisComponent:this});if(this.options.currentLayout.templateId==i){if(this.widgets.layoutUlElement){this.widgets.layoutUlElement.removeChild(j)}else{console.log("Element not available!")}}}},onSelectLayoutClick:function a(j){var s=f.get(this.id+"-layouts-div");var k=f.get(this.id+"-currentLayout-div");f.setStyle(s,"display","none");for(var q in this.options.layouts){var o=this.widgets.layoutLiElements[q];if(j==q){var l=this.options.layouts[q];this.options.currentLayout=l;var p=f.get(this.id+"-currentLayoutDescription-span");p.innerHTML=l.description;var m=f.get(this.id+"-currentLayoutIcon-img");m.src=l.icon;YAHOO.Bubbling.fire("onDashboardLayoutChanged",{dashboardLayout:l})}}var t=f.getChildren(this.widgets.layoutUlElement);for(var n=0;n<t.length;n++){this.widgets.layoutUlElement.removeChild(t[n])}for(var q in this.options.layouts){if(q!=j){this.widgets.layoutUlElement.appendChild(this.widgets.layoutLiElements[q])}}YAHOO.Bubbling.fire("onDashboardLayoutsHidden",{});var r=f.get(this.id+"-changeButtonWrapper-div");f.setStyle(r,"display","")},onChangeButtonClick:function g(j){YAHOO.Bubbling.fire("onDashboardLayoutsDisplayed",{});var i=f.get(this.id+"-changeButtonWrapper-div");f.setStyle(i,"display","none");Alfresco.util.Anim.fadeIn(this.id+"-layouts-div")},onCancelButtonClick:function d(k){var i=f.get(this.id+"-layouts-div");f.setStyle(i,"display","none");YAHOO.Bubbling.fire("onDashboardLayoutsHidden",{});var j=f.get(this.id+"-changeButtonWrapper-div");f.setStyle(j,"display","")}})})();new Alfresco.CustomiseLayout(null);