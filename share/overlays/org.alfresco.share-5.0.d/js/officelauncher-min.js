function EmbeddedOfficeLauncher(){this.ViewDocument=function(L){return g(L,true)};this.EditDocument=function(L){return g(L,false)};this.setConsoleLoggingEnabled=function(L){D=L};this.setRules=function(L){x={};l(L)};this.addRules=function(L){l(L)};this.isAvailable=function(){return e()};this.getLastControlResult=function(){return d};this.isControlBlocked=function(){return(r||b)&&p};this.isWin=function(){return n};this.isMac=function(){return h};this.isIOS=function(){return z};this.isFirefox=function(){return r};this.isChrome=function(){return b};this.isSafari=function(){return k};this.encodeUrl=function(L){return c(L)};this.isControlNotActivated=function(){return p};this.isControlNotActivated=function(){return p};this.isControlActivated=function(){return E()};var s={};s.sp="SharePoint.OpenDocuments";s.ol="OfficeLauncherOrg.OpenDocuments";var K={};K.sp="application/x-sharepoint";K.ol="application/x-officelauncher";var J=navigator.userAgent.toLowerCase();var u=(J.indexOf("msie")!==-1)||(J.indexOf("trident")!==-1);var I=(J.indexOf("opr")!==-1);var b=(J.indexOf("chrome")!==-1)&&(!I);var r=(J.indexOf("firefox")!==-1);var k=(J.indexOf("safari")!==-1)&&(!(b||I));var h=(J.indexOf("mac")!==-1);var n=(J.indexOf("win")!==-1);var z=(J.indexOf("ipad")!==-1)||(J.indexOf("iphone")!==-1)||(J.indexOf("ipod")!==-1);var x={};var o=null;var q=null;var D=false;var d=null;var p=false;l("ax=sp,ol;npapi=sp,ol;npapi.chrome.mac=ol;sp,ol");function g(M,P){p=false;j().log("Opening url = ",M," readOnly = ",P);var O=H();if(O){try{var L;if(P){if(!(u||O.ViewDocument)){p=true}else{L=O.ViewDocument(M)}}else{if(!(u||O.EditDocument)){p=true}else{L=O.EditDocument(M)}}d=L;j().log("Control object invoked successfully. result = ",L);if(L===true||L===0||L==="0"){return true}}catch(N){j().error("Exception invoking control object",N)}}else{j().error("No control object available.")}return false}function E(){j().log("Checking control activation");var L=H();return L&&L.ViewDocument}function H(){if(q){return q}j().log("No control object available. Creating new one.");var L=i();j().log("PlugIn order: ",L);if(window.ActiveXObject!==undefined){j().log("Using ActiveX on this platform.");q=B(L);if(!q){j().log("Failed creating Active-X control.")}return q}else{j().log("Using NPAPI on this platform.");q=A(L);if(!q){j().log("Failed creating NPAPI control.")}return q}}function e(){j().log("Detecting availability on this platform.");var O=i();j().log("PlugIn order: ",O);if(window.ActiveXObject!==undefined){j().log("Using ActiveX on this platform. Trying to create Acrive-X object to detect if launcher is available on this platform.");q=B(O);if(q){j().log("Successfully created ActiveX object. OfficeLauncher is available on this platform.");return true}}else{j().log("Using NPAPI on this platform.");for(var M=0;M<O.length;M++){var N=O[M];var L=K[N];if(L){j().log("Checking availability of "+L);if(f(L)){j().log("Is available. OfficeLauncher is available on this platform.");return true}}}}return false}function B(Q){for(var L=0;L<Q.length;L++){var P=Q[L];j().log('Trying to create ActiveX control for plugin type id "'+P+'"...');try{var M=s[P];if(!M){j().error('No ActiveX ProgId for plugin type id "'+P+'"');continue}j().log('Tying to create ActiveX object with progId "'+M+'"...');var O=new ActiveXObject(M);if(O){j().log("Successfully created ActiveX control: ",O);return O}}catch(N){j().log("Exception creating ActiveX control. progId = ",M," Exception = ",N)}}j().log("No Active-X Object in plugin order could be created.");return null}function A(Q){for(var M=0;M<Q.length;M++){var P=Q[M];j().log('Trying to create NPAPI control for plugin type id "'+P+'"...');try{var L=K[P];if(!L){j().error('No NPAPI mimetype for plugin type id "'+P+'"');continue}j().log('Tying to create NPAPI object with mimetype "'+L+'"...');var O=w(L,"officelauncher-plugin-container-"+P);if(O){j().log("Successfully created NPAPI control: ",O);return O}}catch(N){j().log("Exception creating NPAPI control. mimetype = ",L," Exception = ",N)}}j().log("No NPAPI Object in plugin order could be created.");return null}function i(){if(o){return o}var N=F();var L=a();var M=y();o=x[N+"."+L+"."+M];if(o){return o}o=x[N+"."+L];if(o){return o}o=x[N];if(o){return o}o=x[""];if(o){return o}o=[];return o}function F(){return(window.ActiveXObject!==undefined)?"ax":"npapi"}function a(){if(r){return"firefox"}if(u){return"ie"}if(b){return"chrome"}if(k){return"safari"}return"unknown"}function y(){if(n){return"win"}if(h){return"mac"}return"unknown"}function l(R){var N=R.toLowerCase().split(";");for(var M=0;M<N.length;M++){var P=N[M];var O=P.indexOf("=");var L;var Q;if(O<0){L="";Q=(P.length>0)?P.split(","):[]}else{L=P.substring(0,O);P=P.substring(O+1);Q=(P.length>0)?P.split(","):[]}x[L]=Q}o=null;q=null}function w(P,L){var M=null;try{M=document.getElementById(L);if(!M){j().log("Trying to create NPAPI plugin. mimeType = ",P);if(f(P)){var N=document.createElement("object");N.id=L;N.type=P;N.width=0;N.height=0;N.style.setProperty("visibility","hidden","");document.body.appendChild(N);M=document.getElementById(L)}else{j().log("NPAPI PlugIn is not available. mimeType = ",P)}}}catch(O){j().log("Exception creating NPAPI PlugIn object. mimeType = ",P," Exception = ",O);M=null}return M}function f(L){return navigator&&navigator.mimeTypes&&navigator.mimeTypes[L]&&navigator.mimeTypes[L].enabledPlugin}var t="<>'\"?#@%&`";function c(N){var Q="";var L=0;for(var O=0;O<N.length;O++){var M=N.charCodeAt(O);var R=N.charAt(O);if(M<128){if((M>=33)&&(M<=122)&&(t.indexOf(R)<0)){Q+=N.charAt(O)}else{Q+="%";var P=M.toString(16).toUpperCase();if(P.length<2){Q+="0"}Q+=P}}else{if(M<2048){L=(M>>6)|192;Q+="%"+L.toString(16).toUpperCase();L=(M&63)|128;Q+="%"+L.toString(16).toUpperCase()}else{if((M&64512)!==55296){L=(M>>12)|224;Q+="%"+L.toString(16).toUpperCase();L=((M>>6)&63)|128;Q+="%"+L.toString(16).toUpperCase();L=(M&63)|128;Q+="%"+L.toString(16).toUpperCase()}else{if(O<N.length-1){M=(M&1023)<<10;O++;M=M|(N.charCodeAt(O)&1023);M+=65536;L=(M>>18)|240;Q+="%"+L.toString(16).toUpperCase();L=((M>>12)&63)|128;Q+="%"+L.toString(16).toUpperCase();L=((M>>6)&63)|128;Q+="%"+L.toString(16).toUpperCase();L=(M&63)|128;Q+="%"+L.toString(16).toUpperCase()}}}}}return Q}var v="$<>'\"?#@%&`";function m(N){var Q="";var L=0;for(var O=0;O<N.length;O++){var M=N.charCodeAt(O);var R=N.charAt(O);if(M<128){if((M>=33)&&(M<=122)&&(v.indexOf(R)<0)){Q+=N.charAt(O)}else{Q+="$";var P=M.toString(16).toUpperCase();if(P.length<2){Q+="0"}Q+=P}}else{if(M<2048){L=(M>>6)|192;Q+="$"+L.toString(16).toUpperCase();L=(M&63)|128;Q+="$"+L.toString(16).toUpperCase()}else{if((M&64512)!==55296){L=(M>>12)|224;Q+="$"+L.toString(16).toUpperCase();L=((M>>6)&63)|128;Q+="$"+L.toString(16).toUpperCase();L=(M&63)|128;Q+="$"+L.toString(16).toUpperCase()}else{if(O<N.length-1){M=(M&1023)<<10;O++;M=M|(N.charCodeAt(O)&1023);M+=65536;L=(M>>18)|240;Q+="$"+L.toString(16).toUpperCase();L=((M>>12)&63)|128;Q+="$"+L.toString(16).toUpperCase();L=((M>>6)&63)|128;Q+="$"+L.toString(16).toUpperCase();L=(M&63)|128;Q+="$"+L.toString(16).toUpperCase()}}}}}return Q}function C(){this.log=function(){};this.error=function(){}}var G=new C();function j(){if(D){if(window.console){return window.console}}return G}};